<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mr. Jawad Simulation â€” Trait Predictions: Cracking the Punnett Square</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',system-ui,-apple-system,sans-serif;background:#0a0a1a;color:#fff;min-height:100vh;overflow:hidden;user-select:none;}

/* â•â•â• ANIMATED BG â•â•â• */
.bg-anim{position:fixed;inset:0;z-index:0;overflow:hidden;pointer-events:none;}
.bg-orb{position:absolute;border-radius:50%;filter:blur(80px);opacity:.15;animation:orbFloat 20s ease-in-out infinite;}
.bg-orb:nth-child(1){width:600px;height:600px;background:#9C27B0;top:-200px;left:-100px;animation-delay:0s;}
.bg-orb:nth-child(2){width:500px;height:500px;background:#4CAF50;bottom:-200px;right:-100px;animation-delay:-7s;}
.bg-orb:nth-child(3){width:400px;height:400px;background:#1E88E5;top:50%;left:50%;animation-delay:-14s;}
@keyframes orbFloat{0%,100%{transform:translate(0,0) scale(1);}25%{transform:translate(60px,-40px) scale(1.1);}50%{transform:translate(-30px,50px) scale(.9);}75%{transform:translate(-50px,-20px) scale(1.05);}}

/* â•â•â• SPLASH â•â•â• */
#splash{position:fixed;inset:0;z-index:1000;display:flex;flex-direction:column;align-items:center;justify-content:center;background:linear-gradient(135deg,#0a0a1a 0%,#1a1040 50%,#0a0a1a 100%);transition:opacity .8s;}
.splash-dna{position:relative;width:120px;height:200px;margin-bottom:24px;}
.dna-strand{position:absolute;width:8px;border-radius:4px;animation:dnaRotate 3s ease-in-out infinite;}
.dna-left{left:30px;}
.dna-right{right:30px;}
@keyframes dnaRotate{0%,100%{transform:scaleX(1);}50%{transform:scaleX(-1);}}
.dna-rung{position:absolute;height:6px;border-radius:3px;left:34px;right:34px;}
#splash h1{font-size:2.6rem;font-weight:900;text-align:center;background:linear-gradient(135deg,#4CAF50,#9C27B0,#E91E63);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:8px;letter-spacing:-1px;}
#splash .sub{font-size:1.2rem;color:rgba(255,255,255,.5);margin-bottom:24px;letter-spacing:2px;text-transform:uppercase;font-weight:300;}
#splash .mission-box{max-width:480px;text-align:center;padding:20px 28px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);border-radius:16px;margin-bottom:32px;}
#splash .mission-box p{font-size:1.15rem;color:rgba(255,255,255,.8);line-height:1.6;}
#splash .start-btn{padding:20px 56px;font-size:1.5rem;font-weight:800;border:none;border-radius:60px;background:linear-gradient(135deg,#4CAF50,#2E7D32);color:#fff;cursor:pointer;box-shadow:0 0 40px rgba(76,175,80,.3),0 8px 32px rgba(0,0,0,.4);transition:all .3s;position:relative;overflow:hidden;}
#splash .start-btn:hover{transform:translateY(-3px) scale(1.03);box-shadow:0 0 60px rgba(76,175,80,.5),0 12px 40px rgba(0,0,0,.5);}
#splash .start-btn::after{content:'';position:absolute;inset:-2px;border-radius:62px;background:linear-gradient(135deg,#4CAF50,#9C27B0,#4CAF50);z-index:-1;animation:borderSpin 3s linear infinite;filter:blur(4px);}
@keyframes borderSpin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}

/* â•â•â• GAME LAYOUT â•â•â• */
#game{display:none;position:relative;z-index:1;height:100vh;flex-direction:column;}
.top-bar{background:linear-gradient(90deg,rgba(76,175,80,.85),rgba(156,39,176,.85));padding:8px 20px;display:flex;align-items:center;justify-content:space-between;backdrop-filter:blur(12px);border-bottom:1px solid rgba(255,255,255,.1);flex-shrink:0;}
.top-bar h2{font-size:1rem;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,.3);}
.round-badge{background:rgba(0,0,0,.35);padding:5px 16px;border-radius:20px;font-weight:700;font-size:.9rem;border:1px solid rgba(255,255,255,.15);}
.main-area{display:flex;gap:10px;padding:10px;flex:1;min-height:0;}

/* â•â•â• LEFT PANEL â•â•â• */
.left-panel{width:270px;min-width:270px;display:flex;flex-direction:column;gap:8px;overflow-y:auto;}
.card{background:rgba(255,255,255,.04);border-radius:14px;padding:12px;border:1px solid rgba(255,255,255,.07);backdrop-filter:blur(8px);transition:border-color .3s;}
.card:hover{border-color:rgba(255,255,255,.12);}
.card-title{font-size:.7rem;text-transform:uppercase;letter-spacing:1.5px;color:rgba(255,255,255,.4);margin-bottom:8px;font-weight:600;}

/* Trait Card */
.trait-card{text-align:center;position:relative;overflow:hidden;}
.trait-card::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at top,rgba(156,39,176,.08),transparent 70%);pointer-events:none;}
.trait-badge{display:inline-block;padding:6px 20px;border-radius:20px;background:linear-gradient(135deg,rgba(255,213,79,.2),rgba(255,213,79,.05));border:1px solid rgba(255,213,79,.3);margin-bottom:8px;}
.trait-badge span{font-size:1.1rem;font-weight:800;color:#FFD54F;text-shadow:0 0 12px rgba(255,213,79,.4);}
.trait-vis{display:flex;justify-content:center;gap:20px;margin-top:6px;}
.trait-option{text-align:center;padding:8px 12px;border-radius:12px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);min-width:90px;}
.trait-icon{font-size:2.2rem;display:block;margin-bottom:2px;filter:drop-shadow(0 4px 8px rgba(0,0,0,.3));}
.trait-label{font-size:.65rem;color:rgba(255,255,255,.5);}

/* Parent Selectors */
.parent-info{display:flex;align-items:center;gap:10px;}
.parent-avatar{width:44px;height:44px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.4rem;flex-shrink:0;}
.p1-avatar{background:linear-gradient(135deg,#1E88E5,#1565C0);box-shadow:0 4px 16px rgba(30,136,229,.3);}
.p2-avatar{background:linear-gradient(135deg,#E91E63,#C2185B);box-shadow:0 4px 16px rgba(233,30,99,.3);}
.parent-detail{flex:1;}
.parent-name{font-size:.8rem;font-weight:700;margin-bottom:4px;}
.allele-show{font-family:'Courier New',monospace;font-size:1.3rem;font-weight:900;letter-spacing:2px;}
.al-d{color:#4CAF50;text-shadow:0 0 8px rgba(76,175,80,.5);}
.al-r{color:#f44336;text-shadow:0 0 8px rgba(244,67,54,.5);}
.geno-btns{display:flex;gap:5px;margin-top:6px;}
.geno-btn{flex:1;padding:8px 4px;border:2px solid rgba(255,255,255,.1);border-radius:10px;background:rgba(255,255,255,.03);color:#fff;font-size:.95rem;font-weight:800;cursor:pointer;transition:all .25s;font-family:'Courier New',monospace;text-align:center;}
.geno-btn:hover:not(:disabled){background:rgba(233,30,99,.1);border-color:rgba(233,30,99,.4);transform:translateY(-2px);}
.geno-btn.selected{background:linear-gradient(135deg,#E91E63,#C2185B);border-color:#F48FB1;box-shadow:0 0 16px rgba(233,30,99,.4);transform:translateY(-2px);}
.geno-btn:disabled{opacity:.25;cursor:not-allowed;transform:none;}

/* Prediction */
.predict-card{text-align:center;}
.predict-q{font-size:.85rem;color:rgba(255,255,255,.6);margin-bottom:8px;}
.predict-btns{display:flex;gap:8px;}
.pred-btn{flex:1;padding:10px;border:2px solid rgba(255,255,255,.1);border-radius:12px;background:rgba(255,255,255,.03);color:#fff;font-size:.85rem;font-weight:700;cursor:pointer;transition:all .25s;position:relative;overflow:hidden;}
.pred-btn:hover:not(.locked){border-color:rgba(255,213,79,.4);transform:translateY(-2px);}
.pred-btn.locked{pointer-events:none;opacity:.6;}
.pred-btn.sel-dom{background:linear-gradient(135deg,#4CAF50,#2E7D32);border-color:#81C784;box-shadow:0 0 20px rgba(76,175,80,.3);}
.pred-btn.sel-rec{background:linear-gradient(135deg,#f44336,#c62828);border-color:#ef9a9a;box-shadow:0 0 20px rgba(244,67,54,.3);}

.action-btn{width:100%;padding:13px;border:none;border-radius:14px;font-size:1rem;font-weight:800;cursor:pointer;transition:all .25s;letter-spacing:.5px;text-transform:uppercase;position:relative;overflow:hidden;flex-shrink:0;}
.action-btn:hover:not(.btn-disabled){transform:translateY(-2px);}
.btn-go{background:linear-gradient(135deg,#4CAF50,#2E7D32);color:#fff;box-shadow:0 4px 20px rgba(76,175,80,.35);}
.btn-lock{background:linear-gradient(135deg,#9C27B0,#6A1B9A);color:#fff;box-shadow:0 4px 20px rgba(156,39,176,.35);}
.btn-fill{background:linear-gradient(135deg,#FF9800,#E65100);color:#fff;box-shadow:0 4px 20px rgba(255,152,0,.35);}
.btn-next{background:linear-gradient(135deg,#1E88E5,#1565C0);color:#fff;box-shadow:0 4px 20px rgba(30,136,229,.35);}
.btn-disabled{opacity:.35;pointer-events:none;box-shadow:none;}

/* â•â•â• CENTER ARENA â•â•â• */
.arena{flex:1;background:rgba(255,255,255,.02);border-radius:18px;border:1px solid rgba(255,255,255,.06);display:flex;flex-direction:column;align-items:center;padding:14px 14px 10px;position:relative;overflow:hidden;min-width:0;}
.arena-glow{position:absolute;inset:0;pointer-events:none;}
.arena-glow::before{content:'';position:absolute;width:300px;height:300px;border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%);background:radial-gradient(circle,rgba(156,39,176,.06),transparent 70%);animation:arenaBreath 4s ease-in-out infinite;}
@keyframes arenaBreath{0%,100%{opacity:.5;transform:translate(-50%,-50%) scale(1);}50%{opacity:1;transform:translate(-50%,-50%) scale(1.2);}}

/* Parents Row */
.parents-row{display:flex;align-items:flex-start;justify-content:center;gap:24px;width:100%;z-index:2;margin-bottom:4px;flex-shrink:0;}
.parent-fig{text-align:center;position:relative;}
.fig-body{width:72px;height:72px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2rem;position:relative;box-shadow:0 8px 24px rgba(0,0,0,.3);animation:figBob 4s ease-in-out infinite;}
.fig-p1 .fig-body{background:linear-gradient(135deg,#1E88E5,#1565C0);animation-delay:0s;}
.fig-p2 .fig-body{background:linear-gradient(135deg,#E91E63,#C2185B);animation-delay:-2s;}
@keyframes figBob{0%,100%{transform:translateY(0);}50%{transform:translateY(-5px);}}
.fig-ring{position:absolute;inset:-4px;border-radius:50%;border:2px solid rgba(255,255,255,.15);animation:ringPulse 3s ease-in-out infinite;}
@keyframes ringPulse{0%,100%{opacity:.3;transform:scale(1);}50%{opacity:.7;transform:scale(1.05);}}
.fig-label{font-size:.65rem;color:rgba(255,255,255,.45);margin-top:4px;text-transform:uppercase;letter-spacing:1px;}
.fig-alleles{font-family:'Courier New',monospace;font-size:1.5rem;font-weight:900;margin-top:2px;letter-spacing:2px;}
.cross-symbol{font-size:2.5rem;color:rgba(206,147,216,.6);align-self:center;text-shadow:0 0 20px rgba(156,39,176,.4);margin-top:10px;}

/* Punnett Grid */
.punnett-wrap{position:relative;z-index:2;margin:6px 0;flex-shrink:0;}
.punnett-glow{position:absolute;inset:-20px;border-radius:24px;background:radial-gradient(ellipse,rgba(156,39,176,.08),transparent 70%);pointer-events:none;transition:opacity .5s;}
.punnett-grid{display:grid;grid-template-columns:52px 1fr 1fr;grid-template-rows:44px 1fr 1fr;gap:5px;width:310px;height:270px;position:relative;}
.pg-corner{background:transparent;display:flex;align-items:center;justify-content:center;}
.pg-corner .dna-mini{font-size:1.6rem;animation:figBob 3s ease-in-out infinite;}
.pg-header{background:rgba(255,255,255,.06);border-radius:10px;display:flex;align-items:center;justify-content:center;font-family:'Courier New',monospace;font-size:1.6rem;font-weight:900;border:1px solid rgba(255,255,255,.06);transition:all .4s;}
.pg-header.lit{background:rgba(156,39,176,.15);border-color:rgba(156,39,176,.3);box-shadow:0 0 12px rgba(156,39,176,.2);}
.pg-cell{background:rgba(255,255,255,.03);border-radius:14px;display:flex;flex-direction:column;align-items:center;justify-content:center;border:2px solid rgba(255,255,255,.04);transition:all .6s cubic-bezier(.34,1.56,.64,1);position:relative;overflow:hidden;}
.pg-cell::before{content:'';position:absolute;inset:0;opacity:0;transition:opacity .6s;border-radius:12px;}
.pg-cell.filled-dom{border-color:rgba(76,175,80,.35);}
.pg-cell.filled-dom::before{opacity:1;background:linear-gradient(135deg,rgba(76,175,80,.15),rgba(76,175,80,.05));}
.pg-cell.filled-rec{border-color:rgba(244,67,54,.35);}
.pg-cell.filled-rec::before{opacity:1;background:linear-gradient(135deg,rgba(244,67,54,.15),rgba(244,67,54,.05));}
.pg-cell.revealed{animation:cellReveal .5s cubic-bezier(.34,1.56,.64,1);}
@keyframes cellReveal{0%{transform:scale(0) rotateY(90deg);opacity:0;}50%{transform:scale(1.1) rotateY(0deg);}100%{transform:scale(1) rotateY(0deg);opacity:1;}}
.cell-alleles{font-family:'Courier New',monospace;font-size:1.25rem;font-weight:900;letter-spacing:2px;z-index:1;text-shadow:0 2px 8px rgba(0,0,0,.3);}
.cell-icon{font-size:1.5rem;z-index:1;filter:drop-shadow(0 2px 6px rgba(0,0,0,.3));margin-top:1px;}
.pg-cell.winner{border-color:#FFD54F !important;box-shadow:0 0 30px rgba(255,213,79,.4),inset 0 0 20px rgba(255,213,79,.1);animation:winPulse 1.2s ease-in-out infinite alternate;}
@keyframes winPulse{0%{box-shadow:0 0 20px rgba(255,213,79,.3),inset 0 0 15px rgba(255,213,79,.05);}100%{box-shadow:0 0 40px rgba(255,213,79,.6),inset 0 0 25px rgba(255,213,79,.15);}}

/* Trait Preview in Arena */
.arena-trait-display{width:100%;text-align:center;z-index:2;flex-shrink:0;}
.arena-trait-name{font-size:1rem;font-weight:800;color:#FFD54F;text-shadow:0 0 16px rgba(255,213,79,.3);letter-spacing:1px;}
.arena-trait-icons{display:flex;justify-content:center;gap:32px;margin-top:4px;}
.ati-box{display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.06);background:rgba(255,255,255,.02);min-width:100px;}
.ati-icon{font-size:2.4rem;filter:drop-shadow(0 4px 12px rgba(0,0,0,.4));}
.ati-label{font-size:.6rem;text-transform:uppercase;letter-spacing:1px;font-weight:600;}
.ati-dom .ati-label{color:#4CAF50;}
.ati-rec .ati-label{color:#f44336;}
.ati-dom{border-color:rgba(76,175,80,.15);}
.ati-rec{border-color:rgba(244,67,54,.15);}

/* Offspring Lineup */
.lineup-area{width:100%;z-index:2;margin-top:auto;flex-shrink:0;}
.lineup-label{font-size:.6rem;color:rgba(255,255,255,.3);text-transform:uppercase;letter-spacing:1.5px;margin-bottom:4px;}
.lineup{display:flex;gap:6px;flex-wrap:wrap;min-height:44px;}
.lineup-item{display:flex;flex-direction:column;align-items:center;background:rgba(255,255,255,.05);border-radius:10px;padding:3px 6px;border:1px solid rgba(255,255,255,.06);animation:lineupIn .5s cubic-bezier(.34,1.56,.64,1);}
@keyframes lineupIn{0%{transform:translateY(20px) scale(0);opacity:0;}100%{transform:translateY(0) scale(1);opacity:1;}}
.lineup-item .li-num{font-size:.5rem;color:rgba(255,255,255,.35);}
.lineup-item .li-icon{font-size:1.2rem;}

/* â•â•â• FEEDBACK â•â•â• */
.feedback-layer{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;z-index:20;pointer-events:none;opacity:0;transition:opacity .3s;}
.feedback-layer.show{opacity:1;}
.fb-card{padding:20px 40px;border-radius:20px;text-align:center;animation:fbPop .5s cubic-bezier(.34,1.56,.64,1);}
@keyframes fbPop{0%{transform:scale(0) rotate(-5deg);}60%{transform:scale(1.1) rotate(2deg);}100%{transform:scale(1) rotate(0);}}
.fb-correct{background:linear-gradient(135deg,rgba(76,175,80,.9),rgba(46,125,50,.9));box-shadow:0 8px 40px rgba(76,175,80,.5);}
.fb-wrong{background:linear-gradient(135deg,rgba(244,67,54,.9),rgba(198,40,40,.9));box-shadow:0 8px 40px rgba(244,67,54,.5);}
.fb-icon{font-size:2.5rem;}
.fb-text{font-size:1.3rem;font-weight:800;margin-top:4px;}

/* Particles */
.particle{position:absolute;border-radius:50%;pointer-events:none;z-index:25;}
@keyframes pBurst{0%{opacity:1;transform:translate(0,0) scale(1);}100%{opacity:0;transform:translate(var(--dx),var(--dy)) scale(0);}}
/* Allele fly animation */
@keyframes alleleFly{0%{opacity:1;transform:translate(var(--sx),var(--sy)) scale(1.2);}100%{opacity:1;transform:translate(0,0) scale(1);}}

/* Power-up */
.powerup-toast{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);background:linear-gradient(135deg,#FFD54F,#FF8F00);color:#333;padding:16px 28px;border-radius:16px;font-size:1rem;font-weight:800;z-index:30;box-shadow:0 8px 40px rgba(255,213,79,.5);opacity:0;transition:all .4s cubic-bezier(.34,1.56,.64,1);}
.powerup-toast.show{transform:translate(-50%,-50%) scale(1);opacity:1;}

/* EC message */
.ec-banner{position:absolute;top:8px;right:8px;padding:6px 14px;border-radius:10px;font-size:.75rem;font-weight:700;z-index:5;display:none;animation:fbPop .5s ease-out;}
.ec-req{background:linear-gradient(135deg,#FFD54F,#FF8F00);color:#333;}
.ec-extra{background:linear-gradient(135deg,#7C4DFF,#651FFF);color:#fff;}

/* â•â•â• RIGHT PANEL â•â•â• */
.right-panel{width:280px;min-width:280px;display:flex;flex-direction:column;gap:8px;}
.hud-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px;}
.hud-stat{background:rgba(255,255,255,.04);border-radius:12px;padding:8px 6px;text-align:center;border:1px solid rgba(255,255,255,.05);transition:all .3s;}
.hud-stat .sv{font-size:1.5rem;font-weight:900;transition:all .3s;}
.hud-stat .sl{font-size:.55rem;color:rgba(255,255,255,.35);text-transform:uppercase;letter-spacing:1.5px;margin-top:2px;}
.hs-score .sv{color:#FFD54F;text-shadow:0 0 12px rgba(255,213,79,.3);}
.hs-streak .sv{color:#FF9800;text-shadow:0 0 12px rgba(255,152,0,.3);}
.hs-acc .sv{color:#4CAF50;text-shadow:0 0 12px rgba(76,175,80,.3);}
.hs-round .sv{color:#CE93D8;text-shadow:0 0 12px rgba(206,147,216,.3);}
.hud-stat.bump{animation:hudBump .4s ease-out;}
@keyframes hudBump{0%{transform:scale(1);}40%{transform:scale(1.15);}100%{transform:scale(1);}}

/* Progress */
.prog-wrap{margin-top:6px;}
.prog-bar-outer{background:rgba(255,255,255,.06);border-radius:20px;height:14px;overflow:hidden;border:1px solid rgba(255,255,255,.05);}
.prog-bar-inner{height:100%;border-radius:20px;background:linear-gradient(90deg,#4CAF50,#81C784);transition:width .6s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;}
.prog-bar-inner::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);animation:progShine 2s linear infinite;}
@keyframes progShine{0%{transform:translateX(-100%);}100%{transform:translateX(100%);}}
.prog-msg{font-size:.7rem;color:rgba(255,255,255,.4);margin-top:4px;text-align:center;}

/* Data Table */
.data-section{flex:1;display:flex;flex-direction:column;min-height:0;}
.data-hdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;}
.data-hdr h3{font-size:.65rem;color:rgba(255,255,255,.35);text-transform:uppercase;letter-spacing:1.5px;}
.copy-btn{padding:4px 10px;border:1px solid rgba(255,255,255,.12);border-radius:8px;background:rgba(255,255,255,.04);color:rgba(255,255,255,.7);font-size:.7rem;cursor:pointer;transition:all .2s;font-weight:600;}
.copy-btn:hover{background:rgba(255,255,255,.1);border-color:rgba(255,255,255,.2);}
.copy-btn.copied{background:rgba(76,175,80,.2);border-color:#4CAF50;color:#4CAF50;}
.dtable-wrap{flex:1;overflow-y:auto;border-radius:10px;border:1px solid rgba(255,255,255,.05);}
table.dt{width:100%;border-collapse:collapse;font-size:.68rem;}
table.dt th{background:rgba(156,39,176,.2);padding:5px 3px;text-align:center;position:sticky;top:0;font-size:.6rem;text-transform:uppercase;letter-spacing:.5px;color:rgba(255,255,255,.6);border-bottom:1px solid rgba(156,39,176,.2);}
table.dt td{padding:5px 3px;text-align:center;border-bottom:1px solid rgba(255,255,255,.04);color:rgba(255,255,255,.75);}
table.dt tr.new-row{animation:rowIn .4s ease-out;}
@keyframes rowIn{0%{background:rgba(76,175,80,.15);transform:translateX(-10px);opacity:0;}100%{background:transparent;transform:translateX(0);opacity:1;}}

/* Bottom buttons */
.bot-btns{display:flex;gap:6px;flex-shrink:0;}
.bot-btns button{flex:1;padding:9px;border:none;border-radius:10px;font-size:.8rem;font-weight:700;cursor:pointer;transition:all .2s;text-transform:uppercase;letter-spacing:.5px;}
.bot-btns button:hover{transform:translateY(-2px);}
.b-reset{background:linear-gradient(135deg,#f44336,#c62828);color:#fff;box-shadow:0 4px 16px rgba(244,67,54,.2);}
.b-new{background:linear-gradient(135deg,#1E88E5,#1565C0);color:#fff;box-shadow:0 4px 16px rgba(30,136,229,.2);}

/* â•â•â• COMPLETION OVERLAY â•â•â• */
#completion{display:none;position:fixed;inset:0;z-index:500;flex-direction:column;align-items:center;justify-content:center;background:rgba(0,0,0,.88);backdrop-filter:blur(12px);}
#completion.show{display:flex;}
.comp-badge{font-size:5rem;animation:figBob 2s ease-in-out infinite;}
.comp-title{font-size:2.2rem;font-weight:900;background:linear-gradient(135deg,#4CAF50,#FFD54F,#E91E63);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:12px 0 8px;}
.comp-sub{font-size:1rem;color:rgba(255,255,255,.5);margin-bottom:24px;}
.comp-btns{display:flex;gap:12px;}
.comp-btns button{padding:14px 28px;border:none;border-radius:14px;font-size:.95rem;font-weight:700;cursor:pointer;transition:all .2s;text-transform:uppercase;letter-spacing:.5px;}
.comp-btns button:hover{transform:translateY(-3px);}

/* Scrollbar */
::-webkit-scrollbar{width:4px;}
::-webkit-scrollbar-track{background:transparent;}
::-webkit-scrollbar-thumb{background:rgba(255,255,255,.1);border-radius:2px;}
</style>
</head>
<body>

<div class="bg-anim"><div class="bg-orb"></div><div class="bg-orb"></div><div class="bg-orb"></div></div>

<!-- â•â•â• SPLASH â•â•â• -->
<div id="splash">
  <div class="splash-dna" id="splashDNA"></div>
  <h1>Cracking the Punnett Square</h1>
  <div class="sub">Mr. Jawad Â· Genetics Lab</div>
  <div class="mission-box"><p>Help families predict inherited traits. Build Punnett Squares and crack the genetic code!</p></div>
  <button class="start-btn" onclick="startGame()">Start Lab</button>
</div>

<!-- â•â•â• GAME â•â•â• -->
<div id="game">
  <div class="top-bar">
    <h2>Mr. Jawad Simulation â€” Trait Predictions: Cracking the Punnett Square</h2>
    <div class="round-badge" id="roundBadge">Round 1 / 8</div>
  </div>
  <div class="main-area">

    <!-- LEFT -->
    <div class="left-panel">
      <div class="card trait-card" id="traitCard">
        <div class="card-title">Current Trait</div>
        <div class="trait-badge"><span id="traitName">â€”</span></div>
        <div class="trait-vis" id="traitVis"></div>
      </div>

      <div class="card">
        <div class="card-title">Parent 1 (Preset)</div>
        <div class="parent-info">
          <div class="parent-avatar p1-avatar">ğŸ‘¤</div>
          <div class="parent-detail">
            <div class="parent-name">Parent 1</div>
            <div class="allele-show" id="p1Alleles">â€”</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Parent 2 (You Pick)</div>
        <div class="parent-info" style="margin-bottom:8px;">
          <div class="parent-avatar p2-avatar">ğŸ‘¤</div>
          <div class="parent-detail">
            <div class="parent-name">Parent 2</div>
            <div class="allele-show" id="p2AllelesDisplay"><span style="color:rgba(255,255,255,.25)">Pick below</span></div>
          </div>
        </div>
        <div class="geno-btns" id="p2Btns"></div>
      </div>

      <div class="card predict-card" id="predictSection">
        <div class="card-title">Your Prediction</div>
        <div class="predict-q">Offspring shows?</div>
        <div class="predict-btns">
          <button class="pred-btn" id="predDom" onclick="setPrediction('dominant')">Dominant</button>
          <button class="pred-btn" id="predRec" onclick="setPrediction('recessive')">Recessive</button>
        </div>
      </div>

      <button class="action-btn btn-go btn-disabled" id="actionBtn" onclick="doAction()">Pick Parent 2</button>
    </div>

    <!-- CENTER ARENA -->
    <div class="arena" id="arena">
      <div class="arena-glow"></div>

      <div class="ec-banner ec-req" id="ecReq">âœ“ Required Done! Extra Credit Rounds!</div>
      <div class="ec-banner ec-extra" id="ecExtra">ğŸ† All 8 Complete!</div>

      <!-- Trait Display -->
      <div class="arena-trait-display" id="arenaTraitDisplay">
        <div class="arena-trait-name" id="arenaTraitName">â€”</div>
        <div class="arena-trait-icons" id="arenaTraitIcons"></div>
      </div>

      <!-- Parents -->
      <div class="parents-row">
        <div class="parent-fig fig-p1">
          <div class="fig-body">ğŸ‘¤<div class="fig-ring"></div></div>
          <div class="fig-label">Parent 1</div>
          <div class="fig-alleles" id="arenaP1">â€”</div>
        </div>
        <div class="cross-symbol">Ã—</div>
        <div class="parent-fig fig-p2">
          <div class="fig-body">ğŸ‘¤<div class="fig-ring"></div></div>
          <div class="fig-label">Parent 2</div>
          <div class="fig-alleles" id="arenaP2"><span style="color:rgba(255,255,255,.25)">?</span></div>
        </div>
      </div>

      <!-- Punnett Grid -->
      <div class="punnett-wrap">
        <div class="punnett-glow"></div>
        <div class="punnett-grid" id="punnettGrid">
          <div class="pg-corner"><span class="dna-mini">ğŸ§¬</span></div>
          <div class="pg-header" id="colH0"><span style="color:rgba(255,255,255,.15)">?</span></div>
          <div class="pg-header" id="colH1"><span style="color:rgba(255,255,255,.15)">?</span></div>
          <div class="pg-header" id="rowH0"><span style="color:rgba(255,255,255,.15)">?</span></div>
          <div class="pg-cell" id="cell00"></div>
          <div class="pg-cell" id="cell01"></div>
          <div class="pg-header" id="rowH1"><span style="color:rgba(255,255,255,.15)">?</span></div>
          <div class="pg-cell" id="cell10"></div>
          <div class="pg-cell" id="cell11"></div>
        </div>
      </div>

      <!-- Offspring Lineup -->
      <div class="lineup-area">
        <div class="lineup-label">Offspring Lineup</div>
        <div class="lineup" id="lineup"></div>
      </div>

      <!-- Feedback -->
      <div class="feedback-layer" id="feedbackLayer">
        <div class="fb-card" id="fbCard">
          <div class="fb-icon" id="fbIcon"></div>
          <div class="fb-text" id="fbText"></div>
        </div>
      </div>

      <!-- Power-up -->
      <div class="powerup-toast" id="powerupToast">ğŸ“œ Family History â€” Count recessive boxes Ã· 4 = %</div>
    </div>

    <!-- RIGHT -->
    <div class="right-panel">
      <div class="card">
        <div class="card-title">Stats</div>
        <div class="hud-grid">
          <div class="hud-stat hs-score" id="hsScore"><div class="sv" id="hudScore">0</div><div class="sl">Score</div></div>
          <div class="hud-stat hs-streak" id="hsStreak"><div class="sv" id="hudStreak">0</div><div class="sl">Streak</div></div>
          <div class="hud-stat hs-acc"><div class="sv" id="hudAcc">0/0</div><div class="sl">Accuracy</div></div>
          <div class="hud-stat hs-round"><div class="sv" id="hudRound">1/8</div><div class="sl">Round</div></div>
        </div>
        <div class="prog-wrap">
          <div class="prog-bar-outer"><div class="prog-bar-inner" id="progBar" style="width:0%"></div></div>
          <div class="prog-msg" id="progMsg">Complete 5 rounds</div>
        </div>
      </div>

      <div class="card data-section">
        <div class="data-hdr">
          <h3>Data Table</h3>
          <button class="copy-btn" id="copyBtn" onclick="copyTable()">ğŸ“‹ Copy Table</button>
        </div>
        <div class="dtable-wrap">
          <table class="dt">
            <thead><tr><th>Round</th><th>Parents</th><th>% Rec</th><th>Offspring</th></tr></thead>
            <tbody id="dataBody"></tbody>
          </table>
        </div>
      </div>

      <div class="bot-btns">
        <button class="b-reset" onclick="resetGame()">Reset</button>
        <button class="b-new" onclick="newRun()">New Run</button>
      </div>
    </div>

  </div>
</div>

<!-- â•â•â• COMPLETION â•â•â• -->
<div id="completion">
  <div class="comp-badge" id="compBadge">ğŸ§¬</div>
  <div class="comp-title" id="compTitle">Genetic Counselor!</div>
  <div class="comp-sub" id="compSub"></div>
  <div class="comp-btns">
    <button style="background:linear-gradient(135deg,#1E88E5,#1565C0);color:#fff;" id="compContinue" onclick="continueEC()">Continue â†’ Extra Credit</button>
    <button style="background:linear-gradient(135deg,#9C27B0,#6A1B9A);color:#fff;" onclick="document.getElementById('completion').classList.remove('show')">View Data</button>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ROUND DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ROUNDS=[
  {id:1,trait:"Widow's Peak",domLabel:"Widow's Peak",recLabel:"Straight Hairline",domEmoji:"ğŸ‘©â€ğŸ¦±",recEmoji:"ğŸ‘±",p1:"Bb",p2Options:["BB","Bb","bb"]},
  {id:2,trait:"Earlobes",domLabel:"Free Earlobes",recLabel:"Attached Earlobes",domEmoji:"ğŸ‘‚",recEmoji:"ğŸ”‡",p1:"Bb",p2Options:["BB","Bb","bb"]},
  {id:3,trait:"Hitchhiker's Thumb",domLabel:"Straight Thumb",recLabel:"Hitchhiker's Thumb",domEmoji:"ğŸ‘",recEmoji:"ğŸ¤™",p1:"Bb",p2Options:["BB","Bb","bb"]},
  {id:4,trait:"Dimples",domLabel:"Dimples",recLabel:"No Dimples",domEmoji:"ğŸ˜Š",recEmoji:"ğŸ˜",p1:"Bb",p2Options:["BB","Bb","bb"]},
  {id:5,trait:"Sickle Cell",domLabel:"No Sickle Cell",recLabel:"Sickle Cell",domEmoji:"ğŸ©¸",recEmoji:"ğŸ«",p1:"Bb",p2Options:["BB","Bb","bb"]},
  {id:6,trait:"Sickle Cell",domLabel:"No Sickle Cell",recLabel:"Sickle Cell",domEmoji:"ğŸ©¸",recEmoji:"ğŸ«",p1:"Bb",p2Options:["BB","Bb","bb"]},
  {id:7,trait:"Freckles",domLabel:"Freckles",recLabel:"No Freckles",domEmoji:"ğŸ§‘â€ğŸ¦°",recEmoji:"ğŸ‘¦",p1:"BB",p2Options:["BB","Bb","bb"]},
  {id:8,trait:"Cleft Chin",domLabel:"No Cleft",recLabel:"Cleft Chin",domEmoji:"ğŸ˜€",recEmoji:"ğŸ—¿",p1:"bb",p2Options:["BB","Bb","bb"]}
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let cur=0,score=0,streak=0,bestStreak=0,correct=0,total=0,p2Sel=null,pred=null,phase='pick',rows=[],powerShown=false;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const $=id=>document.getElementById(id);
const cA=a=>`<span class="${a===a.toUpperCase()?'al-d':'al-r'}">${a}</span>`;
const rA=(id,g)=>{$(id).innerHTML=g.split('').map(cA).join('');};
function sortAl(a,b){if(a===a.toUpperCase()&&b===b.toLowerCase())return a+b;if(b===b.toUpperCase()&&a===a.toLowerCase())return b+a;return a+b;}
function bump(id){const el=$(id);el.classList.remove('bump');void el.offsetWidth;el.classList.add('bump');}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// START
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startGame(){
  try{
    $('splash').style.opacity='0';
    setTimeout(()=>{$('splash').style.display='none';$('game').style.display='flex';loadRound();},700);
  }catch(e){console.error(e);}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOAD ROUND
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function loadRound(){
  try{
    if(cur>=8){showComp(true);return;}
    const r=ROUNDS[cur];
    phase='pick';p2Sel=null;pred=null;

    $('roundBadge').textContent=`Round ${r.id} / 8`;
    $('hudRound').textContent=`${r.id}/8`;

    // Trait
    $('traitName').textContent=r.trait;
    $('arenaTraitName').textContent=r.trait;
    $('traitVis').innerHTML=`
      <div class="trait-option"><span class="trait-icon">${r.domEmoji}</span><span class="trait-label">${r.domLabel}</span></div>
      <div class="trait-option"><span class="trait-icon">${r.recEmoji}</span><span class="trait-label">${r.recLabel}</span></div>`;
    $('arenaTraitIcons').innerHTML=`
      <div class="ati-box ati-dom"><span class="ati-icon">${r.domEmoji}</span><span class="ati-label">Dominant</span></div>
      <div class="ati-box ati-rec"><span class="ati-icon">${r.recEmoji}</span><span class="ati-label">Recessive</span></div>`;

    // Parents
    rA('p1Alleles',r.p1);rA('arenaP1',r.p1);
    $('p2AllelesDisplay').innerHTML='<span style="color:rgba(255,255,255,.25)">Pick below</span>';
    $('arenaP2').innerHTML='<span style="color:rgba(255,255,255,.25)">?</span>';

    // P2 buttons
    const bc=$('p2Btns');bc.innerHTML='';
    r.p2Options.forEach(g=>{
      const b=document.createElement('button');
      b.className='geno-btn';b.textContent=g;
      b.onclick=()=>selectP2(g);bc.appendChild(b);
    });

    // Grid reset
    ['colH0','colH1','rowH0','rowH1'].forEach(id=>{$(id).innerHTML='<span style="color:rgba(255,255,255,.15)">?</span>';$(id).classList.remove('lit');});
    ['cell00','cell01','cell10','cell11'].forEach(id=>{const c=$(id);c.innerHTML='';c.className='pg-cell';});

    // Prediction
    $('predDom').className='pred-btn';$('predRec').className='pred-btn';

    // Action
    setBtn('Pick Parent 2','btn-go btn-disabled');

    // EC banners
    $('ecReq').style.display=cur>=5?'block':'none';
    $('ecExtra').style.display='none';

    updateProg();
  }catch(e){console.error(e);}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SELECT P2
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function selectP2(g){
  try{
    if(phase!=='pick')return;
    p2Sel=g;
    document.querySelectorAll('.geno-btn').forEach(b=>b.classList.toggle('selected',b.textContent===g));
    rA('p2AllelesDisplay',g);rA('arenaP2',g);
    phase='predict';
    setBtn('Lock Prediction','btn-lock btn-disabled');
  }catch(e){console.error(e);}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PREDICTION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setPrediction(p){
  try{
    if(phase!=='predict')return;
    pred=p;
    $('predDom').className='pred-btn'+(p==='dominant'?' sel-dom':'');
    $('predRec').className='pred-btn'+(p==='recessive'?' sel-rec':'');
    setBtn('Lock & Fill','btn-lock');
  }catch(e){console.error(e);}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACTION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function doAction(){
  try{
    if(phase==='predict'&&pred)lockAndFill();
    else if(phase==='done'){cur++;if(cur===5)showComp(false);else loadRound();}
  }catch(e){console.error(e);}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOCK & FILL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function lockAndFill(){
  try{
    phase='fill';
    const r=ROUNDS[cur],p1=r.p1,p2=p2Sel;
    document.querySelectorAll('.geno-btn').forEach(b=>b.disabled=true);
    $('predDom').classList.add('locked');$('predRec').classList.add('locked');
    setBtn('Filling...','btn-fill btn-disabled');

    const p1a=p1.split(''),p2a=p2.split('');

    // Light up headers with delay
    setTimeout(()=>{$(  'colH0').innerHTML=cA(p2a[0]);$('colH0').classList.add('lit');},150);
    setTimeout(()=>{$('colH1').innerHTML=cA(p2a[1]);$('colH1').classList.add('lit');},300);
    setTimeout(()=>{$('rowH0').innerHTML=cA(p1a[0]);$('rowH0').classList.add('lit');},450);
    setTimeout(()=>{$('rowH1').innerHTML=cA(p1a[1]);$('rowH1').classList.add('lit');},600);

    const cells=[
      {id:'cell00',a1:p1a[0],a2:p2a[0]},
      {id:'cell01',a1:p1a[0],a2:p2a[1]},
      {id:'cell10',a1:p1a[1],a2:p2a[0]},
      {id:'cell11',a1:p1a[1],a2:p2a[1]}
    ];
    let recCnt=0;const results=[];

    cells.forEach((c,i)=>{
      setTimeout(()=>{
        try{
          const el=$(c.id),pair=sortAl(c.a1,c.a2),isRec=pair===pair.toLowerCase();
          if(isRec)recCnt++;
          results.push({pair,isRec});
          el.innerHTML=`<div class="cell-alleles">${cA(pair[0])}${cA(pair[1])}</div><div class="cell-icon">${isRec?r.recEmoji:r.domEmoji}</div>`;
          el.classList.add(isRec?'filled-rec':'filled-dom','revealed');
          // mini particle per cell
          spawnCellParticles(el,isRec);
          if(i===3)setTimeout(()=>revealOffspring(r,p1,p2,recCnt,results),700);
        }catch(e){console.error(e);}
      },750+i*450);
    });
  }catch(e){console.error(e);}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CELL PARTICLES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function spawnCellParticles(el,isRec){
  try{
    const rect=el.getBoundingClientRect(),arena=$('arena'),aRect=arena.getBoundingClientRect();
    const cx=rect.left-aRect.left+rect.width/2,cy=rect.top-aRect.top+rect.height/2;
    const colors=isRec?['#f44336','#e57373','#ef9a9a']:['#4CAF50','#81C784','#A5D6A7'];
    for(let i=0;i<8;i++){
      const p=document.createElement('div');p.className='particle';
      p.style.background=colors[i%colors.length];
      p.style.width=p.style.height=(4+Math.random()*4)+'px';
      p.style.left=cx+'px';p.style.top=cy+'px';
      const dx=(Math.random()-.5)*120,dy=(Math.random()-.5)*120;
      p.style.setProperty('--dx',dx+'px');p.style.setProperty('--dy',dy+'px');
      p.style.animation=`pBurst ${.4+Math.random()*.4}s ease-out forwards`;
      arena.appendChild(p);
      setTimeout(()=>{try{p.remove();}catch(e){}},900);
    }
  }catch(e){}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// REVEAL OFFSPRING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function revealOffspring(r,p1,p2,recCnt,results){
  try{
    const pctRec=Math.round((recCnt/4)*100);
    const winIdx=Math.floor(Math.random()*4);
    const winner=results[winIdx];
    const pheno=winner.isRec?`Recessive (${r.recLabel})`:`Dominant (${r.domLabel})`;

    // Winner cell glow
    const cellIds=['cell00','cell01','cell10','cell11'];
    $(cellIds[winIdx]).classList.add('winner');

    // Big burst
    spawnBigBurst(winner.isRec);

    // Score
    total++;
    const ok=(pred==='dominant'&&!winner.isRec)||(pred==='recessive'&&winner.isRec);
    if(ok){score+=100+streak*25;streak++;correct++;if(streak>bestStreak)bestStreak=streak;showFB(true);}
    else{streak=0;score+=25;showFB(false);}

    // Power-up
    if(streak>=3&&!powerShown){powerShown=true;showPowerUp();}

    // Lineup
    const li=document.createElement('div');li.className='lineup-item';
    li.innerHTML=`<div class="li-num">R${r.id}</div><div class="li-icon">${winner.isRec?r.recEmoji:r.domEmoji}</div>`;
    $('lineup').appendChild(li);

    // Data
    const row={round:r.id,parents:`${p1} Ã— ${p2}`,pctRec:`${pctRec}%`,offspring:pheno};
    rows.push(row);addRow(row);

    // HUD
    $('hudScore').textContent=score;bump('hsScore');
    $('hudStreak').textContent=streak;bump('hsStreak');
    $('hudAcc').textContent=`${correct}/${total}`;
    updateProg();

    phase='done';
    setBtn(cur===7?'Finish':'Next Round','btn-next');
  }catch(e){console.error(e);}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BIG BURST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function spawnBigBurst(isRec){
  try{
    const arena=$('arena'),colors=isRec
      ?['#f44336','#e57373','#ef9a9a','#FF8A80','#ff6659']
      :['#4CAF50','#81C784','#A5D6A7','#69F0AE','#00E676'];
    for(let i=0;i<30;i++){
      const p=document.createElement('div');p.className='particle';
      const sz=5+Math.random()*8;
      p.style.width=p.style.height=sz+'px';
      p.style.background=colors[Math.floor(Math.random()*colors.length)];
      p.style.left='50%';p.style.top='50%';
      p.style.boxShadow=`0 0 ${sz}px ${colors[0]}40`;
      const angle=Math.random()*Math.PI*2,dist=80+Math.random()*200;
      const dx=Math.cos(angle)*dist,dy=Math.sin(angle)*dist;
      p.style.setProperty('--dx',dx+'px');p.style.setProperty('--dy',dy+'px');
      p.style.animation=`pBurst ${.5+Math.random()*.7}s ease-out forwards`;
      arena.appendChild(p);
      setTimeout(()=>{try{p.remove();}catch(e){}},1400);
    }
  }catch(e){}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FEEDBACK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showFB(ok){
  try{
    const layer=$('feedbackLayer'),card=$('fbCard'),icon=$('fbIcon'),text=$('fbText');
    card.className='fb-card '+(ok?'fb-correct':'fb-wrong');
    icon.textContent=ok?'âœ“':'âœ—';
    text.textContent=ok?'Correct!':'Not Quite';
    layer.classList.add('show');
    setTimeout(()=>layer.classList.remove('show'),1600);
  }catch(e){}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// POWER-UP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showPowerUp(){
  try{
    const t=$('powerupToast');t.classList.add('show');
    setTimeout(()=>t.classList.remove('show'),3500);
  }catch(e){}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addRow(r){
  try{
    const tr=document.createElement('tr');tr.className='new-row';
    tr.innerHTML=`<td>${r.round}</td><td>${r.parents}</td><td>${r.pctRec}</td><td style="font-size:.6rem">${r.offspring}</td>`;
    $('dataBody').appendChild(tr);
    tr.scrollIntoView({behavior:'smooth',block:'nearest'});
  }catch(e){}
}

function copyTable(){
  try{
    if(!rows.length)return;
    let t="Round\tParent Alleles\t% Chance Recessive\tOffspring Phenotype\n";
    rows.forEach(r=>t+=`${r.round}\t${r.parents}\t${r.pctRec}\t${r.offspring}\n`);
    navigator.clipboard.writeText(t).then(()=>copyOK()).catch(()=>{
      const ta=document.createElement('textarea');ta.value=t;document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);copyOK();
    });
  }catch(e){console.error(e);}
}
function copyOK(){const b=$('copyBtn');b.textContent='âœ“ Copied!';b.classList.add('copied');setTimeout(()=>{b.textContent='ğŸ“‹ Copy Table';b.classList.remove('copied');},2000);}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROGRESS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateProg(){
  try{
    const d=rows.length,pct=Math.min(Math.round((d/5)*100),100);
    $('progBar').style.width=pct+'%';
    if(d>=8)$('progMsg').textContent='All 8 complete! Extra Credit!';
    else if(d>=5)$('progMsg').textContent=`${d}/8 â€” Extra credit rounds!`;
    else $('progMsg').textContent=`${d}/5 required â€” ${5-d} more!`;
  }catch(e){}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BTN HELPER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setBtn(txt,cls){const b=$('actionBtn');b.textContent=txt;b.className='action-btn '+cls;}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COMPLETION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showComp(extra){
  try{
    if(extra){
      $('compBadge').textContent='ğŸ†';
      $('compTitle').textContent='Extra Credit Complete!';
      $('compSub').textContent=`Score: ${score} Â· Best Streak: ${bestStreak} Â· Accuracy: ${correct}/${total}`;
      $('compContinue').style.display='none';
      $('ecExtra').style.display='block';
    }else{
      $('compBadge').textContent='ğŸ§¬';
      $('compTitle').textContent='Genetic Counselor Badge!';
      $('compSub').textContent=`5 rounds done! Score: ${score} Â· Streak: ${bestStreak}`;
      $('compContinue').style.display='';
    }
    $('completion').classList.add('show');
  }catch(e){}
}
function continueEC(){$('completion').classList.remove('show');loadRound();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RESET / NEW RUN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function resetGame(){
  cur=0;score=0;streak=0;bestStreak=0;correct=0;total=0;rows=[];powerShown=false;
  $('dataBody').innerHTML='';$('lineup').innerHTML='';
  $('hudScore').textContent='0';$('hudStreak').textContent='0';$('hudAcc').textContent='0/0';
  $('completion').classList.remove('show');
  $('ecReq').style.display='none';$('ecExtra').style.display='none';
  loadRound();
}
function newRun(){resetGame();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SPLASH DNA ANIMATION (CSS-only art)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function buildSplashDNA(){
  try{
    const wrap=$('splashDNA');
    const colors=['#4CAF50','#9C27B0','#E91E63','#1E88E5','#FFD54F','#FF9800'];
    for(let i=0;i<8;i++){
      const rung=document.createElement('div');
      rung.style.cssText=`position:absolute;height:6px;border-radius:3px;left:20px;right:20px;top:${i*24+4}px;background:linear-gradient(90deg,${colors[i%6]},${colors[(i+3)%6]});opacity:.6;animation:dnaRotate ${2+i*.2}s ease-in-out ${i*.15}s infinite;`;
      wrap.appendChild(rung);
    }
  }catch(e){}
})();
</script>
</body>
</html>
