<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr Jawad Simulation Brain Development</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #fff;
            overflow: hidden;
        }

        .container {
            display: flex;
            height: 100vh;
            max-width: 100%;
        }

        /* LEFT SIDEBAR */
        .left-sidebar {
            width: 280px;
            min-width: 280px;
            background: linear-gradient(180deg, #1e1e3f 0%, #2d2d5a 100%);
            padding: 15px;
            display: flex;
            flex-direction: column;
            border-right: 2px solid #4a4a8a;
            overflow-y: auto;
        }

        .sidebar-header {
            text-align: center;
            padding: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            margin-bottom: 12px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .sidebar-header h3 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .scenario-count {
            font-size: 12px;
            opacity: 0.9;
        }

        .scenarios-list {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 12px;
        }

        .scenario-card {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            margin-bottom: 6px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .scenario-card:hover {
            background: rgba(255,255,255,0.1);
            transform: translateX(4px);
        }

        .scenario-card.selected {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.3) 100%);
            border-color: #667eea;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.3);
        }

        .scenario-card.completed {
            opacity: 0.7;
        }

        .scenario-card.completed::after {
            content: '‚úì';
            position: absolute;
            right: 10px;
            color: #4ade80;
            font-weight: bold;
            font-size: 16px;
        }

        .scenario-emoji {
            font-size: 24px;
            margin-right: 10px;
        }

        .scenario-name {
            font-size: 13px;
            font-weight: 500;
        }

        .divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, #667eea, transparent);
            margin: 12px 0;
        }

        .section-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #a0a0c0;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .reading-level-tabs {
            display: flex;
            gap: 6px;
            margin-bottom: 12px;
        }

        .level-tab {
            flex: 1;
            padding: 8px 4px;
            text-align: center;
            background: rgba(255,255,255,0.05);
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            font-weight: 600;
        }

        .level-tab:hover {
            background: rgba(255,255,255,0.1);
        }

        .level-tab.active {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: #000;
            box-shadow: 0 0 10px rgba(74, 222, 128, 0.4);
        }

        .key-words-section {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 12px;
        }

        .key-word {
            display: inline-block;
            padding: 4px 8px;
            margin: 3px;
            background: rgba(139, 92, 246, 0.3);
            border-radius: 6px;
            font-size: 11px;
            color: #c4b5fd;
        }

        .button-group {
            display: flex;
            gap: 8px;
            margin-top: auto;
        }

        .btn-reset {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .btn-new {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .btn-reset:hover, .btn-new:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        /* CENTER PANEL */
        .center-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 15px;
            overflow: hidden;
        }

        .title-bar {
            text-align: center;
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border-radius: 15px;
            margin-bottom: 12px;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
        }

        .title-bar h1 {
            font-size: 20px;
            font-weight: 700;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .mission-text {
            font-size: 12px;
            opacity: 0.9;
            margin-top: 4px;
        }

        .step-tabs {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .step-tab {
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 25px;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s ease;
            opacity: 0.5;
        }

        .step-tab.active {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #000;
            opacity: 1;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
            animation: glow 2s ease-in-out infinite;
        }

        .step-tab.completed {
            background: rgba(74, 222, 128, 0.3);
            opacity: 0.7;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(251, 191, 36, 0.5); }
            50% { box-shadow: 0 0 30px rgba(251, 191, 36, 0.8); }
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .content-card {
            width: 100%;
            max-width: 700px;
            background: rgba(255,255,255,0.08);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            display: none;
        }

        .content-card.visible {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
        }

        .welcome-screen h2 {
            font-size: 28px;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea 0%, #f093fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .welcome-screen p {
            font-size: 16px;
            opacity: 0.8;
            margin-bottom: 10px;
        }

        .detective-badge {
            font-size: 80px;
            margin: 20px 0;
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Predict Screen */
        .predict-question {
            text-align: center;
        }

        .predict-question h3 {
            font-size: 22px;
            margin-bottom: 20px;
            color: #fbbf24;
        }

        .scenario-preview {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .scenario-preview-emoji {
            font-size: 50px;
            margin-bottom: 10px;
        }

        .scenario-preview-name {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #c4b5fd;
        }

        .scenario-preview-desc {
            font-size: 15px;
            opacity: 0.9;
        }

        .predict-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        .predict-btn {
            padding: 15px 40px;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .predict-btn.helps {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: #000;
        }

        .predict-btn.hurts {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: #fff;
        }

        .predict-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        /* Read Screen */
        .reading-card {
            position: relative;
        }

        .reading-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .reading-title {
            font-size: 20px;
            color: #fbbf24;
        }

        .reading-level-badge {
            padding: 5px 12px;
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .reading-text {
            font-size: 17px;
            line-height: 1.8;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-radius: 15px;
            margin-bottom: 15px;
            max-height: 250px;
            overflow-y: auto;
        }

        .reading-text .keyword {
            color: #c4b5fd;
            font-weight: 600;
            background: rgba(139, 92, 246, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
        }

        .reading-text .highlight {
            background: rgba(251, 191, 36, 0.3);
            padding: 2px 0;
            border-radius: 3px;
            transition: background 0.3s ease;
        }

        .reading-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .btn-read-aloud {
            padding: 12px 25px;
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-read-aloud:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
        }

        .btn-read-aloud.speaking {
            animation: pulse 1s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Watch Screen */
        .brain-meter {
            text-align: center;
        }

        .brain-meter h3 {
            font-size: 20px;
            margin-bottom: 20px;
            color: #fbbf24;
        }

        .meter-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 25px;
        }

        .meter-bar {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .meter-label {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .bar-track {
            width: 60px;
            height: 200px;
            background: rgba(0,0,0,0.3);
            border-radius: 30px;
            position: relative;
            overflow: hidden;
            border: 3px solid rgba(255,255,255,0.2);
        }

        .bar-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            border-radius: 0 0 27px 27px;
            transition: height 1s ease, background 0.5s ease;
        }

        .bar-fill.focus {
            background: linear-gradient(180deg, #60a5fa 0%, #3b82f6 100%);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }

        .bar-fill.memory {
            background: linear-gradient(180deg, #c084fc 0%, #a855f7 100%);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
        }

        .bar-fill.stress {
            background: linear-gradient(180deg, #f87171 0%, #ef4444 100%);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
        }

        .bar-value {
            margin-top: 10px;
            font-size: 18px;
            font-weight: 700;
        }

        .ok-zone {
            position: absolute;
            left: -5px;
            right: -5px;
            background: rgba(74, 222, 128, 0.2);
            border: 2px dashed #4ade80;
            border-radius: 5px;
        }

        .meter-status {
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 15px;
        }

        .meter-status.good {
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.3) 0%, rgba(34, 197, 94, 0.3) 100%);
            border: 2px solid #4ade80;
            color: #4ade80;
        }

        .meter-status.bad {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.3) 0%, rgba(220, 38, 38, 0.3) 100%);
            border: 2px solid #ef4444;
            color: #ef4444;
        }

        /* Record Screen */
        .record-screen {
            text-align: center;
        }

        .record-screen h3 {
            font-size: 22px;
            margin-bottom: 15px;
            color: #4ade80;
        }

        .record-summary {
            background: rgba(0,0,0,0.2);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .record-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .record-row:last-child {
            border-bottom: none;
        }

        .prediction-result {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            padding: 15px;
            border-radius: 12px;
        }

        .prediction-result.correct {
            background: rgba(74, 222, 128, 0.2);
            border: 2px solid #4ade80;
        }

        .prediction-result.incorrect {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
        }

        .prediction-result-icon {
            font-size: 30px;
        }

        .prediction-result-text {
            font-size: 16px;
            font-weight: 600;
        }

        /* Action Button */
        .action-area {
            margin-top: auto;
            padding-top: 15px;
            display: flex;
            justify-content: center;
        }

        .btn-action {
            padding: 15px 40px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border: none;
            border-radius: 15px;
            color: #000;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(251, 191, 36, 0.4);
        }

        .btn-action:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 25px rgba(251, 191, 36, 0.6);
        }

        .btn-action:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* RIGHT SIDEBAR */
        .right-sidebar {
            width: 280px;
            min-width: 280px;
            background: linear-gradient(180deg, #1e1e3f 0%, #2d2d5a 100%);
            padding: 15px;
            display: flex;
            flex-direction: column;
            border-left: 2px solid #4a4a8a;
            overflow-y: auto;
        }

        .progress-header {
            text-align: center;
            padding: 10px;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            border-radius: 12px;
            margin-bottom: 12px;
            color: #000;
            font-weight: 700;
        }

        .hud-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 12px;
        }

        .hud-stat {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 10px;
            text-align: center;
        }

        .hud-stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #fbbf24;
        }

        .hud-stat-label {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 3px;
        }

        .progress-bar-container {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ade80 0%, #22c55e 100%);
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .progress-message {
            text-align: center;
            font-size: 13px;
            color: #a0a0c0;
            margin-bottom: 12px;
        }

        .data-table-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px 10px 0 0;
            padding: 10px;
            text-align: center;
            font-weight: 700;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .copy-table-btn {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            border: none;
            border-radius: 8px;
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 600;
            color: #000;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .copy-table-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(74, 222, 128, 0.4);
        }

        .copy-table-btn.copied {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        }

        .data-table-container {
            flex: 1;
            overflow-y: auto;
            background: rgba(0,0,0,0.2);
            border-radius: 0 0 10px 10px;
        }

        .data-table {
            width: 100%;
            font-size: 11px;
        }

        .data-table th {
            background: rgba(102, 126, 234, 0.3);
            padding: 8px 4px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .data-table td {
            padding: 6px 4px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .data-table tr:hover {
            background: rgba(255,255,255,0.05);
        }

        .helps-badge {
            color: #4ade80;
            font-weight: 600;
        }

        .hurts-badge {
            color: #ef4444;
            font-weight: 600;
        }

        /* Animations */
        .bar-animate {
            animation: barPulse 0.5s ease;
        }

        @keyframes barPulse {
            0%, 100% { transform: scaleX(1); }
            50% { transform: scaleX(1.1); }
        }

        /* Completion Modal */
        .completion-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .completion-modal.visible {
            display: flex;
        }

        .completion-content {
            background: linear-gradient(135deg, #1e1e3f 0%, #2d2d5a 100%);
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            max-width: 500px;
            border: 3px solid #4ade80;
            box-shadow: 0 0 50px rgba(74, 222, 128, 0.3);
        }

        .completion-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .completion-title {
            font-size: 28px;
            color: #4ade80;
            margin-bottom: 15px;
        }

        .completion-message {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 25px;
        }

        .extra-credit-prompt {
            background: rgba(251, 191, 36, 0.2);
            border: 2px solid #fbbf24;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .extra-credit-prompt h4 {
            color: #fbbf24;
            margin-bottom: 8px;
        }

        .btn-continue {
            padding: 15px 35px;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            border: none;
            border-radius: 12px;
            color: #000;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            margin: 5px;
        }

        .btn-finish {
            padding: 15px 35px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 12px;
            color: #fff;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            margin: 5px;
        }

        /* Streak Badge */
        .streak-badge {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #000;
            padding: 20px 40px;
            border-radius: 20px;
            font-size: 24px;
            font-weight: 700;
            z-index: 500;
            display: none;
            animation: streakPop 0.5s ease;
        }

        .streak-badge.visible {
            display: block;
        }

        @keyframes streakPop {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(102, 126, 234, 0.5);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(102, 126, 234, 0.8);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- LEFT SIDEBAR -->
        <div class="left-sidebar">
            <div class="sidebar-header">
                <h3>üîç Pick Any Scenario</h3>
                <div class="scenario-count">Choose 5 you want to explore!</div>
            </div>
            
            <div class="scenarios-list" id="scenariosList">
                <!-- Scenarios populated by JS -->
            </div>
            
            <div class="divider"></div>
            
            <div class="section-label">Reading Level</div>
            <div class="reading-level-tabs">
                <div class="level-tab active" data-level="low" onclick="setReadingLevel('low')">Low</div>
                <div class="level-tab" data-level="med" onclick="setReadingLevel('med')">Med</div>
                <div class="level-tab" data-level="high" onclick="setReadingLevel('high')">High</div>
            </div>
            
            <div class="divider"></div>
            
            <div class="section-label">Key Words</div>
            <div class="key-words-section" id="keyWordsSection">
                <span class="key-word">Cortisol</span>
                <span class="key-word">Working memory</span>
                <span class="key-word">Spaced practice</span>
                <span class="key-word">Fixed mindset</span>
                <span class="key-word">Growth mindset</span>
                <span class="key-word">Flow state</span>
            </div>
            
            <div class="button-group">
                <button class="btn-reset" onclick="resetSimulation()">Reset</button>
                <button class="btn-new" onclick="newRun()">New Run</button>
            </div>
        </div>

        <!-- CENTER PANEL -->
        <div class="center-panel">
            <div class="title-bar">
                <h1>üß† Mr Jawad Simulation: Brain Development</h1>
                <div class="mission-text">Discover what helps or hurts your brain's ability to learn!</div>
            </div>
            
            <div class="step-tabs">
                <div class="step-tab" id="step1">1. PREDICT</div>
                <div class="step-tab" id="step2">2. READ</div>
                <div class="step-tab" id="step3">3. WATCH</div>
                <div class="step-tab" id="step4">4. RECORD</div>
            </div>
            
            <div class="main-content">
                <!-- Welcome Screen -->
                <div class="content-card visible" id="welcomeScreen">
                    <div class="welcome-screen">
                        <div class="detective-badge">üïµÔ∏è</div>
                        <h2>Brain Performance Detective</h2>
                        <p>Same brain, different conditions, totally different results.</p>
                        <p>Investigate 8 real-life scenarios to discover what helps or hurts your brain!</p>
                        <p style="margin-top: 20px; color: #fbbf24;">üëà Pick any scenario to start!</p>
                    </div>
                </div>
                
                <!-- Predict Screen -->
                <div class="content-card" id="predictScreen">
                    <div class="predict-question">
                        <h3>ü§î Make Your Prediction</h3>
                        <div class="scenario-preview">
                            <div class="scenario-preview-emoji" id="predictEmoji"></div>
                            <div class="scenario-preview-name" id="predictName"></div>
                            <div class="scenario-preview-desc" id="predictDesc"></div>
                        </div>
                        <p style="margin-bottom: 20px;">Will this condition HELP or HURT learning?</p>
                        <div class="predict-buttons">
                            <button class="predict-btn helps" onclick="makePrediction('helps')">‚úì HELPS</button>
                            <button class="predict-btn hurts" onclick="makePrediction('hurts')">‚úó HURTS</button>
                        </div>
                    </div>
                </div>
                
                <!-- Read Screen -->
                <div class="content-card" id="readScreen">
                    <div class="reading-card">
                        <div class="reading-header">
                            <div class="reading-title" id="readTitle">üìñ What Happens to the Brain</div>
                            <div class="reading-level-badge" id="readLevelBadge">LOW</div>
                        </div>
                        <div class="reading-text" id="readingText"></div>
                        <div class="reading-actions">
                            <button class="btn-read-aloud" id="btnReadAloud" onclick="toggleReadAloud()">
                                <span>üîä</span> Read Aloud
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Watch Screen -->
                <div class="content-card" id="watchScreen">
                    <div class="brain-meter">
                        <h3>üß† Brain Performance Meter</h3>
                        <div class="meter-container">
                            <div class="meter-bar">
                                <div class="meter-label">üéØ Focus</div>
                                <div class="bar-track">
                                    <div class="ok-zone" style="bottom: 60%; height: 35%;"></div>
                                    <div class="bar-fill focus" id="focusBar" style="height: 50%;"></div>
                                </div>
                                <div class="bar-value" id="focusValue">50%</div>
                            </div>
                            <div class="meter-bar">
                                <div class="meter-label">üß† Memory</div>
                                <div class="bar-track">
                                    <div class="ok-zone" style="bottom: 60%; height: 35%;"></div>
                                    <div class="bar-fill memory" id="memoryBar" style="height: 50%;"></div>
                                </div>
                                <div class="bar-value" id="memoryValue">50%</div>
                            </div>
                            <div class="meter-bar">
                                <div class="meter-label">‚ö†Ô∏è Stress</div>
                                <div class="bar-track">
                                    <div class="ok-zone" style="bottom: 5%; height: 30%;"></div>
                                    <div class="bar-fill stress" id="stressBar" style="height: 50%;"></div>
                                </div>
                                <div class="bar-value" id="stressValue">50%</div>
                            </div>
                        </div>
                        <div class="meter-status" id="meterStatus">Watching brain respond...</div>
                    </div>
                </div>
                
                <!-- Record Screen -->
                <div class="content-card" id="recordScreen">
                    <div class="record-screen">
                        <h3>‚úÖ Data Recorded!</h3>
                        <div class="record-summary" id="recordSummary">
                            <!-- Filled by JS -->
                        </div>
                        <div class="prediction-result" id="predictionResult">
                            <span class="prediction-result-icon"></span>
                            <span class="prediction-result-text"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="action-area">
                <button class="btn-action" id="actionBtn" style="display: none;" onclick="handleAction()">Continue</button>
            </div>
        </div>

        <!-- RIGHT SIDEBAR -->
        <div class="right-sidebar">
            <div class="progress-header">üìä Progress</div>
            
            <div class="hud-stats">
                <div class="hud-stat">
                    <div class="hud-stat-value" id="scoreValue">0</div>
                    <div class="hud-stat-label">Score</div>
                </div>
                <div class="hud-stat">
                    <div class="hud-stat-value" id="streakValue">0</div>
                    <div class="hud-stat-label">Streak</div>
                </div>
                <div class="hud-stat">
                    <div class="hud-stat-value" id="completedValue">0/5</div>
                    <div class="hud-stat-label">Completed</div>
                </div>
                <div class="hud-stat">
                    <div class="hud-stat-value" id="accuracyValue">--%</div>
                    <div class="hud-stat-label">Accuracy</div>
                </div>
            </div>
            
            <div class="progress-bar-container">
                <div class="progress-bar-fill" id="progressBar" style="width: 0%;"></div>
            </div>
            <div class="progress-message" id="progressMessage">Pick 5 scenarios you like!</div>
            
            <div class="data-table-header">
                <span>üìã Data Table</span>
                <button class="copy-table-btn" id="copyTableBtn" onclick="copyTableToClipboard()">üìã Copy Table</button>
            </div>
            <div class="data-table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Scenario</th>
                            <th>Changed</th>
                            <th>Brain</th>
                            <th>Result</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody">
                        <!-- Rows added by JS -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Completion Modal -->
    <div class="completion-modal" id="completionModal">
        <div class="completion-content">
            <div class="completion-icon" id="completionIcon">üéâ</div>
            <div class="completion-title" id="completionTitle">Required Complete!</div>
            <div class="completion-message" id="completionMessage">You've completed 5 scenarios!</div>
            <div class="extra-credit-prompt" id="extraCreditPrompt">
                <h4>üåü Extra Credit Available!</h4>
                <p>Complete all 8 scenarios for extra credit!</p>
            </div>
            <button class="btn-continue" onclick="continueForExtraCredit()">Keep Going!</button>
            <button class="btn-finish" onclick="finishSimulation()">I'm Done</button>
        </div>
    </div>

    <!-- Streak Badge -->
    <div class="streak-badge" id="streakBadge">üî• Streak!</div>

    <script>
        // Scenario Data
        const scenarios = [
            {
                id: 1,
                name: "Multitasking",
                emoji: "üì±",
                description: "Student does homework while texting and watching TV at the same time.",
                actual: "hurts",
                readings: {
                    low: `You try to do homework while texting and watching TV. Your brain cannot focus on all three things at once. Your <span class="keyword">working memory</span> fills up fast. Your Focus bar drops and your Stress bar rises.`,
                    med: `You sit down to do homework but keep your phone nearby. Every time it buzzes, you check it. The TV is also on in the background. Your brain tries to switch between all three tasks, but your <span class="keyword">working memory</span> can only hold so much. Each switch costs you focus. Your Focus bar drops sharply and your Stress bar creeps up.`,
                    high: `You start your homework with your phone, TV, and laptop all going at once. Every notification pulls your attention away. Your brain has to restart each time you switch tasks. Scientists call this "task-switching cost." Your <span class="keyword">working memory</span> gets overloaded trying to track everything. Your brain releases <span class="keyword">cortisol</span> because it feels overwhelmed. Your Focus bar crashes down and your Stress bar spikes. This is one of the worst conditions for learning.`
                },
                bars: { focus: 20, memory: 35, stress: 85 },
                whatChanged: "Homework + texting + TV",
                brainResponse: "Focus ‚Üì, Stress ‚Üë"
            },
            {
                id: 2,
                name: "All-Nighter",
                emoji: "üò¥",
                description: "Student stays up until 3am cramming for a test.",
                actual: "hurts",
                readings: {
                    low: `You stay up until 3am cramming for a test. Your brain is too tired to move information into long-term memory. Your Memory bar drops low. Your Stress bar rises because your body needs sleep.`,
                    med: `The test is tomorrow and you have not studied yet. You decide to stay up all night cramming. Your brain gets more and more tired as the hours pass. Sleep is when your brain moves new learning into long-term memory. Without sleep, your <span class="keyword">working memory</span> cannot do its job. Your Memory bar drops and your Stress bar rises as your body releases <span class="keyword">cortisol</span>.`,
                    high: `You have a big test tomorrow but you have not started studying. You decide to pull an all-nighter and study until 3am. At first, you feel okay. But as the night goes on, your brain gets slower and slower. Your <span class="keyword">working memory</span> struggles to hold new information. Sleep is when your brain strengthens memories, and you are skipping that step. Your body releases <span class="keyword">cortisol</span> because it is stressed and exhausted. Your Memory bar crashes and your Stress bar spikes. You might remember less than if you had slept.`
                },
                bars: { focus: 30, memory: 20, stress: 80 },
                whatChanged: "Cramming until 3am",
                brainResponse: "Memory ‚Üì‚Üì, Stress ‚Üë"
            },
            {
                id: 3,
                name: "Test Freeze",
                emoji: "üò∞",
                description: "Student knows the material but freezes up during the test.",
                actual: "hurts",
                readings: {
                    low: `You studied hard and know the material. But when the test starts, your mind goes blank. Too much <span class="keyword">cortisol</span> blocks your <span class="keyword">working memory</span>. Your Stress bar spikes and your Memory bar drops.`,
                    med: `You studied for days and felt ready. But when you sit down for the test, your heart races. Your hands get sweaty and your mind goes blank. This is test anxiety, and it floods your brain with <span class="keyword">cortisol</span>. The stress chemical blocks your <span class="keyword">working memory</span> from finding answers you actually know. Your Stress bar spikes hard and your Memory bar drops even though you studied.`,
                    high: `You spent all week studying and felt confident. You knew the answers yesterday. But when the teacher hands out the test, your heart starts pounding. Your hands shake and your mind goes completely blank. This is called test anxiety, and it is caused by too much <span class="keyword">cortisol</span> flooding your brain. The stress chemical actually blocks access to your <span class="keyword">working memory</span>. The information is still in there, but stress locks the door. Your Stress bar spikes into the danger zone and your Memory bar drops. You freeze up even though you really do know the material.`
                },
                bars: { focus: 25, memory: 25, stress: 95 },
                whatChanged: "Anxiety during test",
                brainResponse: "Stress ‚Üë‚Üë, Memory ‚Üì"
            },
            {
                id: 4,
                name: "A Little Daily",
                emoji: "üéØ",
                description: "Student practices 20 minutes every day instead of cramming.",
                actual: "helps",
                readings: {
                    low: `You study for 20 minutes every day instead of cramming. Your brain has time to rest between sessions. This is called <span class="keyword">spaced practice</span>. Your Memory bar rises high and your Stress bar stays low.`,
                    med: `Instead of cramming the night before, you practice for 20 minutes every day. Each day your brain gets a chance to rest and strengthen what you learned. Scientists call this <span class="keyword">spaced practice</span>, and it is one of the best ways to learn. Your <span class="keyword">working memory</span> moves information into long-term storage while you sleep. You feel calm and confident when test day comes. Your Memory bar rises high and your Stress bar stays safely low.`,
                    high: `You have a test in one week. Instead of waiting until the last minute, you study for 20 minutes every single day. Each session is short, but your brain has time to process between sessions. Sleep strengthens the connections every night. Scientists call this <span class="keyword">spaced practice</span>, and research shows it beats cramming every time. Your <span class="keyword">working memory</span> does not get overloaded because you take breaks. You keep <span class="keyword">cortisol</span> low because you are not stressed or rushed. Your Memory bar climbs high into the green zone. Your Stress bar stays safely low, giving you the best conditions for learning.`
                },
                bars: { focus: 75, memory: 90, stress: 15 },
                whatChanged: "20 min daily practice",
                brainResponse: "Memory ‚Üë‚Üë, Stress ‚Üì"
            },
            {
                id: 5,
                name: "Quick Fixes",
                emoji: "üîÑ",
                description: "Student gets mistakes corrected fast and tries again right away.",
                actual: "helps",
                readings: {
                    low: `You make a mistake on a problem. Your teacher corrects it right away and you try again. Fast feedback helps your brain learn what went wrong. Your Focus bar rises and your Memory bar rises too.`,
                    med: `You are working on a math problem and get it wrong. Instead of waiting days to find out, your teacher tells you right away. You see exactly what went wrong and try again. This fast feedback helps your brain make stronger connections. Your <span class="keyword">working memory</span> catches the mistake while it is still fresh. Your Focus bar and Memory bar both rise because your brain learned from the error quickly.`,
                    high: `You are working through practice problems and get one wrong. Your teacher corrects it immediately and explains what happened. You try the problem again right away while it is still fresh in your mind. This is how your brain learns best, by catching mistakes quickly. Your <span class="keyword">working memory</span> can still see what went wrong and fix the connection. If you waited days for feedback, you might repeat the same mistake over and over. Quick correction keeps your Focus bar high because you stay engaged. Your Memory bar also rises as your brain strengthens the right pathway. Low stress and high focus create ideal learning conditions.`
                },
                bars: { focus: 85, memory: 80, stress: 20 },
                whatChanged: "Fast feedback + retry",
                brainResponse: "Focus ‚Üë, Memory ‚Üë"
            },
            {
                id: 6,
                name: '"I Can\'t"',
                emoji: "üö´",
                description: "Student believes they are bad at the subject and gives up.",
                actual: "hurts",
                readings: {
                    low: `You believe you are bad at this subject. You think your brain cannot change. This is called a <span class="keyword">fixed mindset</span>. All three bars drop because you stop trying.`,
                    med: `You look at a hard problem and think "I can't do this." You believe some people are just bad at certain subjects. Scientists call this a <span class="keyword">fixed mindset</span>, believing your brain cannot change. When you think this way, you stop trying and your brain stops learning. Your Focus bar drops because you give up. Your Memory bar drops because you are not practicing. Your Stress bar rises from frustration.`,
                    high: `You sit down to study but immediately think "I'm just not a math person." You believe that some people are born smart and others are not. Scientists call this a <span class="keyword">fixed mindset</span>, the belief that your brain cannot grow or change. But research shows this is wrong. Your brain actually changes every time you practice something hard. When you have a <span class="keyword">fixed mindset</span>, you give up quickly because you think trying is pointless. Your Focus bar crashes because you stop engaging. Your Memory bar drops because you are not practicing. Your Stress bar rises from frustration and shame. A <span class="keyword">fixed mindset</span> creates some of the worst conditions for learning.`
                },
                bars: { focus: 15, memory: 20, stress: 75 },
                whatChanged: "Believing \"I can't\"",
                brainResponse: "All bars ‚Üì"
            },
            {
                id: 7,
                name: "Deep Focus",
                emoji: "üéÆ",
                description: "Student learns something they love and loses track of time.",
                actual: "helps",
                readings: {
                    low: `You are learning something you love. You get so focused that you lose track of time. This is called a <span class="keyword">flow state</span>. Your Focus bar maxes out and your Stress bar drops low.`,
                    med: `You are working on something you really love, maybe coding, art, or a game you enjoy. You get so absorbed that you forget about everything else. Time seems to fly by. Scientists call this a <span class="keyword">flow state</span>, and it is one of the best conditions for learning. Your brain releases chemicals that help memory and focus. Your Focus bar maxes out and your Stress bar drops because you feel calm and engaged.`,
                    high: `You are working on something you genuinely love, maybe a video game, drawing, music, or building something cool. You get so absorbed that you forget about time completely. An hour feels like ten minutes. Scientists call this a <span class="keyword">flow state</span>, and it is when your brain learns best. Your <span class="keyword">working memory</span> runs at full power because nothing is distracting you. Your brain releases feel-good chemicals instead of <span class="keyword">cortisol</span>. You have a <span class="keyword">growth mindset</span> because you want to get better at something you care about. Your Focus bar maxes out at the highest level. Your Stress bar drops to almost nothing. This is the peak condition for learning anything.`
                },
                bars: { focus: 95, memory: 85, stress: 10 },
                whatChanged: "Learning what you love",
                brainResponse: "Focus ‚Üë‚Üë, Stress ‚Üì‚Üì"
            },
            {
                id: 8,
                name: "Move First",
                emoji: "üèÉ",
                description: "Student exercises before studying.",
                actual: "helps",
                readings: {
                    low: `You exercise before you start studying. Moving your body sends blood and oxygen to your brain. All three bars improve. Your Focus rises, your Memory rises, and your Stress drops.`,
                    med: `Before you sit down to study, you go for a run or do some jumping jacks. Exercise pumps blood and oxygen to your brain. It also releases chemicals that help you focus and feel calm. Your brain is now primed and ready to learn. Your Focus bar rises because you feel alert. Your Memory bar rises and your Stress bar drops because exercise lowers <span class="keyword">cortisol</span>.`,
                    high: `You have a lot of studying to do, but before you start, you go outside and run around for fifteen minutes. Exercise sends extra blood and oxygen straight to your brain. It also releases chemicals that improve mood and focus while lowering <span class="keyword">cortisol</span>. Scientists have proven that students who exercise before studying remember more and focus better. Your <span class="keyword">working memory</span> works more efficiently after movement. You feel calm, alert, and ready to learn. Your Focus bar rises because your brain is awake. Your Memory bar rises because blood flow helps lock in information. Your Stress bar drops because exercise naturally calms your body. This is one of the simplest ways to boost your learning power.`
                },
                bars: { focus: 85, memory: 85, stress: 15 },
                whatChanged: "Exercise before study",
                brainResponse: "All bars ‚Üë"
            }
        ];

        // Game State
        let state = {
            currentScenario: null,
            currentStep: 0, // 0=none, 1=predict, 2=read, 3=watch, 4=record
            readingLevel: 'low',
            prediction: null,
            completedScenarios: [],
            score: 0,
            streak: 0,
            correctPredictions: 0,
            totalPredictions: 0,
            dataRows: [],
            speechSynthesis: null,
            isSpeaking: false
        };

        // Initialize
        function init() {
            renderScenarios();
            updateHUD();
        }

        function renderScenarios() {
            const list = document.getElementById('scenariosList');
            list.innerHTML = scenarios.map(s => `
                <div class="scenario-card ${state.completedScenarios.includes(s.id) ? 'completed' : ''}" 
                     id="scenario-${s.id}" 
                     onclick="selectScenario(${s.id})">
                    <span class="scenario-emoji">${s.emoji}</span>
                    <span class="scenario-name">${s.name}</span>
                </div>
            `).join('');
        }

        function selectScenario(id) {
            if (state.currentStep > 0 && state.currentStep < 4) return; // Can't switch mid-scenario
            
            const scenario = scenarios.find(s => s.id === id);
            state.currentScenario = scenario;
            state.currentStep = 1;
            state.prediction = null;
            
            // Update UI
            document.querySelectorAll('.scenario-card').forEach(c => c.classList.remove('selected'));
            document.getElementById(`scenario-${id}`).classList.add('selected');
            
            showPredictScreen();
            updateStepTabs();
        }

        function showPredictScreen() {
            hideAllScreens();
            document.getElementById('predictScreen').classList.add('visible');
            document.getElementById('predictEmoji').textContent = state.currentScenario.emoji;
            document.getElementById('predictName').textContent = state.currentScenario.name;
            document.getElementById('predictDesc').textContent = state.currentScenario.description;
            document.getElementById('actionBtn').style.display = 'none';
        }

        function makePrediction(pred) {
            state.prediction = pred;
            state.currentStep = 2;
            state.totalPredictions++;
            showReadScreen();
            updateStepTabs();
        }

        function showReadScreen() {
            hideAllScreens();
            document.getElementById('readScreen').classList.add('visible');
            
            const levelText = state.readingLevel === 'low' ? 'LOW' : state.readingLevel === 'med' ? 'MEDIUM' : 'HIGH';
            document.getElementById('readLevelBadge').textContent = levelText;
            document.getElementById('readingText').innerHTML = state.currentScenario.readings[state.readingLevel];
            
            document.getElementById('actionBtn').style.display = 'block';
            document.getElementById('actionBtn').textContent = 'üëÄ Watch the Brain Respond';
        }

        function setReadingLevel(level) {
            state.readingLevel = level;
            document.querySelectorAll('.level-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[data-level="${level}"]`).classList.add('active');
            
            if (state.currentStep === 2) {
                const levelText = level === 'low' ? 'LOW' : level === 'med' ? 'MEDIUM' : 'HIGH';
                document.getElementById('readLevelBadge').textContent = levelText;
                document.getElementById('readingText').innerHTML = state.currentScenario.readings[level];
            }
        }

        function toggleReadAloud() {
            const btn = document.getElementById('btnReadAloud');
            
            if (state.isSpeaking) {
                window.speechSynthesis.cancel();
                state.isSpeaking = false;
                btn.classList.remove('speaking');
                btn.innerHTML = '<span>üîä</span> Read Aloud';
                return;
            }
            
            const text = document.getElementById('readingText').innerText;
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 0.9;
            
            utterance.onend = () => {
                state.isSpeaking = false;
                btn.classList.remove('speaking');
                btn.innerHTML = '<span>üîä</span> Read Aloud';
            };
            
            state.isSpeaking = true;
            btn.classList.add('speaking');
            btn.innerHTML = '<span>‚èπÔ∏è</span> Stop';
            window.speechSynthesis.speak(utterance);
        }

        function showWatchScreen() {
            if (state.isSpeaking) {
                window.speechSynthesis.cancel();
                state.isSpeaking = false;
            }
            
            hideAllScreens();
            document.getElementById('watchScreen').classList.add('visible');
            document.getElementById('actionBtn').style.display = 'none';
            state.currentStep = 3;
            updateStepTabs();
            
            // Reset bars to 50%
            document.getElementById('focusBar').style.height = '50%';
            document.getElementById('memoryBar').style.height = '50%';
            document.getElementById('stressBar').style.height = '50%';
            document.getElementById('focusValue').textContent = '50%';
            document.getElementById('memoryValue').textContent = '50%';
            document.getElementById('stressValue').textContent = '50%';
            document.getElementById('meterStatus').textContent = 'Watching brain respond...';
            document.getElementById('meterStatus').className = 'meter-status';
            
            // Animate bars after delay
            setTimeout(() => {
                const bars = state.currentScenario.bars;
                animateBar('focusBar', 'focusValue', bars.focus);
                animateBar('memoryBar', 'memoryValue', bars.memory);
                animateBar('stressBar', 'stressValue', bars.stress);
                
                // Update status
                setTimeout(() => {
                    const isGood = state.currentScenario.actual === 'helps';
                    const status = document.getElementById('meterStatus');
                    status.textContent = isGood ? '‚úì Good for Learning!' : '‚úó Bad for Learning!';
                    status.className = 'meter-status ' + (isGood ? 'good' : 'bad');
                    
                    document.getElementById('actionBtn').style.display = 'block';
                    document.getElementById('actionBtn').textContent = 'üìù Record Data';
                }, 1200);
            }, 500);
        }

        function animateBar(barId, valueId, targetPercent) {
            const bar = document.getElementById(barId);
            const value = document.getElementById(valueId);
            
            bar.classList.add('bar-animate');
            bar.style.height = targetPercent + '%';
            value.textContent = targetPercent + '%';
            
            setTimeout(() => bar.classList.remove('bar-animate'), 500);
        }

        function showRecordScreen() {
            hideAllScreens();
            document.getElementById('recordScreen').classList.add('visible');
            state.currentStep = 4;
            updateStepTabs();
            
            const scenario = state.currentScenario;
            const isCorrect = state.prediction === scenario.actual;
            
            // Update score and streak
            if (isCorrect) {
                state.correctPredictions++;
                state.streak++;
                state.score += 100 + (state.streak * 10);
                
                if (state.streak >= 2) {
                    showStreakBadge();
                }
            } else {
                state.streak = 0;
                state.score += 50;
            }
            
            // Add to completed
            if (!state.completedScenarios.includes(scenario.id)) {
                state.completedScenarios.push(scenario.id);
            }
            
            // Add data row
            state.dataRows.push({
                scenario: scenario.name,
                whatChanged: scenario.whatChanged,
                brainResponse: scenario.brainResponse,
                result: scenario.actual
            });
            
            // Update record summary
            const summary = document.getElementById('recordSummary');
            summary.innerHTML = `
                <div class="record-row">
                    <span>Scenario:</span>
                    <span>${scenario.emoji} ${scenario.name}</span>
                </div>
                <div class="record-row">
                    <span>What Changed:</span>
                    <span>${scenario.whatChanged}</span>
                </div>
                <div class="record-row">
                    <span>Brain Response:</span>
                    <span>${scenario.brainResponse}</span>
                </div>
                <div class="record-row">
                    <span>Result:</span>
                    <span class="${scenario.actual === 'helps' ? 'helps-badge' : 'hurts-badge'}">${scenario.actual.toUpperCase()}</span>
                </div>
            `;
            
            // Update prediction result
            const predResult = document.getElementById('predictionResult');
            predResult.className = 'prediction-result ' + (isCorrect ? 'correct' : 'incorrect');
            predResult.innerHTML = `
                <span class="prediction-result-icon">${isCorrect ? 'üéØ' : 'ü§î'}</span>
                <span class="prediction-result-text">${isCorrect ? 'Your prediction was correct!' : 'Not quite! Keep observing patterns.'}</span>
            `;
            
            updateHUD();
            updateDataTable();
            renderScenarios();
            
            document.getElementById('actionBtn').style.display = 'block';
            document.getElementById('actionBtn').textContent = 'üîç Pick Next Scenario';
            
            // Check completion
            if (state.completedScenarios.length === 5) {
                setTimeout(() => showCompletionModal(false), 1500);
            } else if (state.completedScenarios.length === 8) {
                setTimeout(() => showCompletionModal(true), 1500);
            }
        }

        function handleAction() {
            if (state.currentStep === 2) {
                showWatchScreen();
            } else if (state.currentStep === 3) {
                showRecordScreen();
            } else if (state.currentStep === 4) {
                returnToWelcome();
            }
        }

        function returnToWelcome() {
            state.currentScenario = null;
            state.currentStep = 0;
            state.prediction = null;
            
            document.querySelectorAll('.scenario-card').forEach(c => c.classList.remove('selected'));
            hideAllScreens();
            document.getElementById('welcomeScreen').classList.add('visible');
            document.getElementById('actionBtn').style.display = 'none';
            updateStepTabs();
        }

        function hideAllScreens() {
            document.querySelectorAll('.content-card').forEach(c => c.classList.remove('visible'));
        }

        function updateStepTabs() {
            const tabs = ['step1', 'step2', 'step3', 'step4'];
            tabs.forEach((tabId, index) => {
                const tab = document.getElementById(tabId);
                tab.className = 'step-tab';
                if (index + 1 === state.currentStep) {
                    tab.classList.add('active');
                } else if (index + 1 < state.currentStep) {
                    tab.classList.add('completed');
                }
            });
        }

        function updateHUD() {
            document.getElementById('scoreValue').textContent = state.score;
            document.getElementById('streakValue').textContent = state.streak;
            document.getElementById('completedValue').textContent = `${state.completedScenarios.length}/5`;
            
            const accuracy = state.totalPredictions > 0 
                ? Math.round((state.correctPredictions / state.totalPredictions) * 100) 
                : '--';
            document.getElementById('accuracyValue').textContent = accuracy + '%';
            
            const progress = Math.min((state.completedScenarios.length / 5) * 100, 100);
            document.getElementById('progressBar').style.width = progress + '%';
            
            const remaining = Math.max(5 - state.completedScenarios.length, 0);
            if (remaining > 0) {
                document.getElementById('progressMessage').textContent = `Pick ${remaining} more you like!`;
            } else if (state.completedScenarios.length < 8) {
                document.getElementById('progressMessage').textContent = `‚úì Required done! ${8 - state.completedScenarios.length} for extra credit`;
            } else {
                document.getElementById('progressMessage').textContent = 'üåü Extra Credit Complete!';
            }
        }

        function updateDataTable() {
            const tbody = document.getElementById('dataTableBody');
            tbody.innerHTML = state.dataRows.map(row => `
                <tr>
                    <td>${row.scenario}</td>
                    <td>${row.whatChanged}</td>
                    <td>${row.brainResponse}</td>
                    <td class="${row.result === 'helps' ? 'helps-badge' : 'hurts-badge'}">${row.result}</td>
                </tr>
            `).join('');
        }

        function showStreakBadge() {
            const badge = document.getElementById('streakBadge');
            badge.textContent = `üî• ${state.streak} Streak!`;
            badge.classList.add('visible');
            setTimeout(() => badge.classList.remove('visible'), 1500);
        }

        function showCompletionModal(isExtraCredit) {
            const modal = document.getElementById('completionModal');
            const icon = document.getElementById('completionIcon');
            const title = document.getElementById('completionTitle');
            const message = document.getElementById('completionMessage');
            const extraPrompt = document.getElementById('extraCreditPrompt');
            
            if (isExtraCredit) {
                icon.textContent = 'üèÜ';
                title.textContent = 'Extra Credit Complete!';
                message.textContent = `Amazing! You completed all 8 scenarios with ${state.score} points!`;
                extraPrompt.style.display = 'none';
            } else {
                icon.textContent = 'üéâ';
                title.textContent = 'Required Complete!';
                message.textContent = `Great work! You completed 5 scenarios with ${state.score} points!`;
                extraPrompt.style.display = 'block';
            }
            
            modal.classList.add('visible');
        }

        function continueForExtraCredit() {
            document.getElementById('completionModal').classList.remove('visible');
            returnToWelcome();
        }

        function finishSimulation() {
            document.getElementById('completionModal').classList.remove('visible');
            // Could show final summary here
        }

        function resetSimulation() {
            if (state.isSpeaking) {
                window.speechSynthesis.cancel();
                state.isSpeaking = false;
            }
            
            state = {
                currentScenario: null,
                currentStep: 0,
                readingLevel: 'low',
                prediction: null,
                completedScenarios: [],
                score: 0,
                streak: 0,
                correctPredictions: 0,
                totalPredictions: 0,
                dataRows: [],
                speechSynthesis: null,
                isSpeaking: false
            };
            
            document.querySelectorAll('.level-tab').forEach(t => t.classList.remove('active'));
            document.querySelector('[data-level="low"]').classList.add('active');
            
            init();
            returnToWelcome();
        }

        function newRun() {
            resetSimulation();
        }

        function copyTableToClipboard() {
            if (state.dataRows.length === 0) {
                const btn = document.getElementById('copyTableBtn');
                btn.textContent = 'No data yet!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'üìã Copy Table';
                    btn.classList.remove('copied');
                }, 2000);
                return;
            }
            
            // Build tab-separated text
            let tableText = "Scenario\tWhat Changed?\tBrain Response\tHelps or Hurts?\n";
            for (const row of state.dataRows) {
                tableText += `${row.scenario}\t${row.whatChanged}\t${row.brainResponse}\t${row.result}\n`;
            }
            
            // Copy to clipboard
            navigator.clipboard.writeText(tableText).then(() => {
                const btn = document.getElementById('copyTableBtn');
                btn.textContent = '‚úì Copied!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'üìã Copy Table';
                    btn.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy:', err);
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = tableText;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                const btn = document.getElementById('copyTableBtn');
                btn.textContent = '‚úì Copied!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'üìã Copy Table';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }

        // Initialize on load
        init();
    </script>
</body>
</html>
