<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mr. Jawad Simulation ‚Äî Your Genetic Code</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',system-ui,-apple-system,sans-serif;background:#0a0e1a;color:#e0e0e0;overflow:hidden;height:100vh;display:flex;flex-direction:column;}
/* TITLE BAR */
.title-bar{background:linear-gradient(135deg,#1a237e,#4a148c,#880e4f);padding:8px 16px;text-align:center;font-size:18px;font-weight:700;color:#fff;letter-spacing:1px;text-shadow:0 2px 8px rgba(0,0,0,.5);flex-shrink:0;border-bottom:2px solid rgba(255,255,255,.1);}
/* MAIN LAYOUT */
.main{display:flex;flex:1;overflow:hidden;}
/* LEFT SIDEBAR */
.left-sb{width:280px;min-width:280px;background:linear-gradient(180deg,#141825,#1a1f30);border-right:1px solid rgba(255,255,255,.08);display:flex;flex-direction:column;overflow-y:auto;}
.left-sb::-webkit-scrollbar{width:4px;}
.left-sb::-webkit-scrollbar-thumb{background:rgba(255,255,255,.15);border-radius:4px;}
.sb-header{padding:12px 14px 6px;font-size:13px;font-weight:700;color:#b388ff;text-transform:uppercase;letter-spacing:1.5px;}
.scenario-count{font-size:11px;color:#888;font-weight:400;margin-top:2px;}
.scenario-card{margin:3px 10px;padding:10px 12px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);border-radius:10px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:10px;position:relative;}
.scenario-card:hover{background:rgba(255,255,255,.08);border-color:rgba(179,136,255,.3);transform:translateX(3px);}
.scenario-card.selected{background:linear-gradient(135deg,rgba(179,136,255,.15),rgba(233,30,99,.1));border-color:#b388ff;box-shadow:0 0 12px rgba(179,136,255,.2);}
.scenario-card.completed{opacity:.7;}
.scenario-card.completed::after{content:'‚úì';position:absolute;right:10px;top:50%;transform:translateY(-50%);color:#69f0ae;font-size:16px;font-weight:700;}
.sc-emoji{font-size:24px;flex-shrink:0;}
.sc-name{font-size:12px;font-weight:600;line-height:1.3;}
.divider{height:1px;background:rgba(255,255,255,.08);margin:8px 14px;}
.rl-section{padding:8px 14px;}
.rl-label{font-size:11px;font-weight:700;color:#80cbc4;text-transform:uppercase;letter-spacing:1px;margin-bottom:6px;}
.rl-tabs{display:flex;gap:4px;}
.rl-tab{flex:1;padding:6px 0;text-align:center;font-size:12px;font-weight:600;border-radius:6px;cursor:pointer;transition:all .2s;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);color:#aaa;}
.rl-tab.active{background:linear-gradient(135deg,#00897b,#00695c);color:#fff;border-color:#00897b;box-shadow:0 0 8px rgba(0,137,123,.3);}
.kw-section{padding:8px 14px;}
.kw-label{font-size:11px;font-weight:700;color:#ffab40;text-transform:uppercase;letter-spacing:1px;margin-bottom:6px;}
.kw-list{display:flex;flex-wrap:wrap;gap:4px;}
.kw-tag{padding:3px 8px;font-size:11px;border-radius:12px;background:rgba(255,171,64,.08);border:1px solid rgba(255,171,64,.15);color:#ffcc80;transition:all .3s;}
.kw-tag.highlighted{background:rgba(255,171,64,.2);border-color:#ffab40;color:#fff;box-shadow:0 0 6px rgba(255,171,64,.2);}
.bottom-btns{padding:10px 14px;display:flex;gap:8px;margin-top:auto;}
.btn-reset{flex:1;padding:8px;border:none;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;transition:all .2s;background:linear-gradient(135deg,#c62828,#b71c1c);color:#fff;}
.btn-newrun{flex:1;padding:8px;border:none;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;transition:all .2s;background:linear-gradient(135deg,#1565c0,#0d47a1);color:#fff;}
.btn-reset:hover,.btn-newrun:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.3);}
/* CENTER PANEL */
.center{flex:1;display:flex;flex-direction:column;overflow:hidden;background:linear-gradient(180deg,#10141f,#151a28);}
/* STEP TABS */
.step-tabs{display:flex;padding:8px 16px;gap:6px;flex-shrink:0;background:rgba(0,0,0,.2);}
.step-tab{flex:1;padding:8px 0;text-align:center;font-size:13px;font-weight:700;border-radius:8px;background:rgba(255,255,255,.04);color:#555;transition:all .4s;border:1px solid transparent;}
.step-tab.active{background:linear-gradient(135deg,#7c4dff,#e040fb);color:#fff;box-shadow:0 0 20px rgba(124,77,255,.3);border-color:rgba(255,255,255,.15);animation:tabGlow 2s ease-in-out infinite;}
.step-tab.done{background:rgba(105,240,174,.1);color:#69f0ae;border-color:rgba(105,240,174,.2);}
@keyframes tabGlow{0%,100%{box-shadow:0 0 15px rgba(124,77,255,.25);}50%{box-shadow:0 0 25px rgba(124,77,255,.45);}}
/* CENTER CONTENT */
.center-content{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:16px;overflow:hidden;position:relative;}
.content-card{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:24px;max-width:720px;width:100%;box-shadow:0 8px 32px rgba(0,0,0,.2);position:relative;}
/* PREDICT */
.predict-area{text-align:center;}
.predict-emoji{font-size:48px;margin-bottom:12px;}
.predict-title{font-size:20px;font-weight:700;color:#b388ff;margin-bottom:8px;}
.predict-q{font-size:15px;color:#ccc;line-height:1.5;margin-bottom:16px;}
.predict-btns{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;}
.predict-btn{padding:10px 20px;border:2px solid rgba(179,136,255,.3);border-radius:10px;background:rgba(179,136,255,.08);color:#e0e0e0;font-size:13px;font-weight:600;cursor:pointer;transition:all .2s;}
.predict-btn:hover{background:rgba(179,136,255,.2);border-color:#b388ff;transform:translateY(-2px);box-shadow:0 4px 16px rgba(179,136,255,.2);}
/* READ */
.read-area{max-height:100%;overflow:hidden;}
.read-title{font-size:16px;font-weight:700;color:#80cbc4;margin-bottom:10px;display:flex;align-items:center;gap:8px;}
.passage-box{background:rgba(255,255,255,.06);border-radius:12px;padding:16px 20px;line-height:1.7;font-size:15px;color:#ddd;max-height:320px;overflow-y:auto;}
.passage-box::-webkit-scrollbar{width:4px;}
.passage-box::-webkit-scrollbar-thumb{background:rgba(255,255,255,.15);border-radius:4px;}
.passage-box .kw{color:#ffab40;font-weight:700;}
.passage-box .sentence-highlight{background:rgba(255,171,64,.15);border-radius:4px;padding:1px 2px;}
/* WATCH */
.watch-area{text-align:center;width:100%;}
.watch-title{font-size:16px;font-weight:700;color:#ff80ab;margin-bottom:12px;}
.arena{width:100%;height:340px;background:linear-gradient(180deg,#0d1117,#161b22);border-radius:16px;border:1px solid rgba(255,255,255,.06);position:relative;overflow:hidden;}
.gauge-container{position:absolute;bottom:16px;left:50%;transform:translateX(-50%);width:85%;height:50px;}
.gauge-track{width:100%;height:20px;border-radius:10px;background:linear-gradient(90deg,#fdd835 0%,#66bb6a 35%,#66bb6a 65%,#42a5f5 100%);position:relative;overflow:visible;box-shadow:inset 0 2px 6px rgba(0,0,0,.3);}
.gauge-labels{display:flex;justify-content:space-between;margin-top:4px;font-size:10px;font-weight:700;}
.gauge-labels span:first-child{color:#fdd835;}
.gauge-labels span:nth-child(2){color:#66bb6a;}
.gauge-labels span:last-child{color:#42a5f5;}
.gauge-indicator{position:absolute;top:-6px;width:16px;height:32px;background:#fff;border-radius:4px;box-shadow:0 0 12px rgba(255,255,255,.6);transition:left 1.5s cubic-bezier(.34,1.56,.64,1);left:50%;}
.gauge-zone-label{position:absolute;top:-18px;font-size:9px;font-weight:700;white-space:nowrap;transform:translateX(-50%);padding:2px 6px;border-radius:4px;}
/* ARENA VISUALS */
.arena-content{position:absolute;top:10px;left:10px;right:10px;bottom:75px;display:flex;align-items:center;justify-content:center;}
.arena-visual{width:100%;height:100%;position:relative;}
/* RECORD */
.record-area{text-align:center;}
.record-emoji{font-size:48px;margin-bottom:8px;}
.record-msg{font-size:18px;font-weight:700;color:#69f0ae;margin-bottom:6px;}
.record-sub{font-size:13px;color:#888;}
/* ACTION BTN */
.action-row{padding:12px 16px;text-align:center;flex-shrink:0;}
.action-btn{padding:12px 32px;border:none;border-radius:10px;font-size:14px;font-weight:700;cursor:pointer;transition:all .25s;background:linear-gradient(135deg,#7c4dff,#e040fb);color:#fff;box-shadow:0 4px 16px rgba(124,77,255,.3);}
.action-btn:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(124,77,255,.4);}
.action-btn:disabled{opacity:.4;cursor:default;transform:none;box-shadow:none;}
.read-aloud-btn{padding:10px 20px;border:2px solid rgba(128,203,188,.3);border-radius:10px;background:rgba(128,203,188,.08);color:#80cbc4;font-size:13px;font-weight:600;cursor:pointer;transition:all .2s;margin-left:8px;}
.read-aloud-btn:hover{background:rgba(128,203,188,.2);border-color:#80cbc4;}
.read-aloud-btn.reading{background:#00897b;color:#fff;border-color:#00897b;}
/* WELCOME STATE */
.welcome{text-align:center;padding:40px 20px;}
.welcome-emoji{font-size:64px;margin-bottom:16px;}
.welcome-title{font-size:22px;font-weight:700;background:linear-gradient(135deg,#b388ff,#ff80ab);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px;}
.welcome-sub{font-size:14px;color:#888;line-height:1.5;}
/* RIGHT SIDEBAR */
.right-sb{width:280px;min-width:280px;background:linear-gradient(180deg,#141825,#1a1f30);border-left:1px solid rgba(255,255,255,.08);display:flex;flex-direction:column;overflow-y:auto;}
.right-sb::-webkit-scrollbar{width:4px;}
.right-sb::-webkit-scrollbar-thumb{background:rgba(255,255,255,.15);border-radius:4px;}
.progress-header{padding:12px 14px 6px;font-size:13px;font-weight:700;color:#ff80ab;text-transform:uppercase;letter-spacing:1.5px;}
.hud-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px;padding:6px 14px;}
.hud-item{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);border-radius:8px;padding:8px;text-align:center;}
.hud-val{font-size:20px;font-weight:800;color:#fff;}
.hud-label{font-size:10px;color:#888;text-transform:uppercase;letter-spacing:.5px;margin-top:2px;}
.hud-val.score{color:#ffd740;}
.hud-val.streak{color:#ff80ab;}
.hud-val.completed{color:#69f0ae;}
.hud-val.accuracy{color:#80d8ff;}
.progress-bar-wrap{padding:6px 14px;}
.progress-bar-outer{width:100%;height:10px;background:rgba(255,255,255,.06);border-radius:5px;overflow:hidden;}
.progress-bar-inner{height:100%;background:linear-gradient(90deg,#69f0ae,#00e676);border-radius:5px;transition:width .5s;width:0%;}
.progress-status{font-size:11px;color:#888;text-align:center;margin-top:4px;padding:0 14px;}
.data-header{padding:10px 14px 4px;font-size:13px;font-weight:700;color:#80cbc4;text-transform:uppercase;letter-spacing:1.5px;display:flex;align-items:center;justify-content:space-between;}
.copy-btn{padding:4px 10px;border:1px solid rgba(128,203,188,.3);border-radius:6px;background:rgba(128,203,188,.08);color:#80cbc4;font-size:11px;font-weight:600;cursor:pointer;transition:all .2s;}
.copy-btn:hover{background:rgba(128,203,188,.2);}
.copy-btn.copied{background:#00897b;color:#fff;border-color:#00897b;}
.data-table-wrap{padding:4px 10px;flex:1;overflow-y:auto;}
.data-table{width:100%;border-collapse:collapse;font-size:10px;}
.data-table th{background:rgba(128,203,188,.15);color:#80cbc4;padding:5px 4px;text-align:left;font-size:9px;text-transform:uppercase;letter-spacing:.5px;border-bottom:1px solid rgba(128,203,188,.2);position:sticky;top:0;}
.data-table td{padding:4px;border-bottom:1px solid rgba(255,255,255,.04);color:#bbb;vertical-align:top;line-height:1.3;}
.data-table tr:nth-child(even){background:rgba(255,255,255,.02);}
.data-table tr.new-row{animation:rowFlash .6s;}
@keyframes rowFlash{0%{background:rgba(105,240,174,.2);}100%{background:transparent;}}
/* HIDDEN */
.hidden{display:none!important;}
/* COMPLETION */
.completion-banner{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#1a237e,#4a148c);border:2px solid #b388ff;border-radius:20px;padding:30px 40px;text-align:center;z-index:100;box-shadow:0 0 60px rgba(179,136,255,.3);animation:bannerPop .5s cubic-bezier(.34,1.56,.64,1);}
@keyframes bannerPop{0%{transform:translate(-50%,-50%) scale(0);opacity:0;}100%{transform:translate(-50%,-50%) scale(1);opacity:1;}}
.completion-banner h2{font-size:28px;margin-bottom:8px;}
.completion-banner p{font-size:14px;color:#ccc;}
.completion-banner .close-banner{margin-top:12px;padding:8px 24px;border:none;border-radius:8px;background:#b388ff;color:#fff;font-weight:700;cursor:pointer;}
/* Extra Credit banner */
.ec-banner{background:linear-gradient(135deg,#e65100,#bf360c)!important;border-color:#ff6d00!important;}
/* PARTICLES */
.particle{position:absolute;border-radius:50%;pointer-events:none;animation:particleFade 2s forwards;}
@keyframes particleFade{0%{opacity:1;transform:translateY(0) scale(1);}100%{opacity:0;transform:translateY(-40px) scale(0);}}
/* SAFETY RULES */
.safety-rules{margin:6px 14px;padding:8px 10px;background:rgba(255,235,59,.05);border:1px solid rgba(255,235,59,.1);border-radius:8px;font-size:10px;color:#999;line-height:1.4;}
.safety-rules strong{color:#ffee58;}
</style>
</head>
<body>
<div class="title-bar">üß¨ Mr. Jawad Simulation ‚Äî Your Genetic Code: The Code That Changed Everything</div>
<div class="main">
<!-- LEFT SIDEBAR -->
<div class="left-sb">
<div class="sb-header">Pick Any 5 You Like <div class="scenario-count" id="scenarioCount">0 of 8 completed</div></div>
<div id="scenarioList"></div>
<div class="divider"></div>
<div class="rl-section">
<div class="rl-label">Reading Level</div>
<div class="rl-tabs">
<div class="rl-tab active" data-level="low" onclick="setReadingLevel('low')">Low</div>
<div class="rl-tab" data-level="med" onclick="setReadingLevel('med')">Med</div>
<div class="rl-tab" data-level="high" onclick="setReadingLevel('high')">High</div>
</div>
</div>
<div class="divider"></div>
<div class="kw-section">
<div class="kw-label">Key Words</div>
<div class="kw-list" id="kwList"></div>
</div>
<div class="divider"></div>
<div class="safety-rules"><strong>Rules:</strong> No wrong predictions. Complete 5+ scenarios. Your data must match what you read and watched.</div>
<div class="bottom-btns">
<button class="btn-reset" onclick="resetSim()">Reset</button>
<button class="btn-newrun" onclick="newRun()">New Run</button>
</div>
</div>

<!-- CENTER PANEL -->
<div class="center">
<div class="step-tabs">
<div class="step-tab" id="tab1">1. PREDICT</div>
<div class="step-tab" id="tab2">2. READ</div>
<div class="step-tab" id="tab3">3. WATCH</div>
<div class="step-tab" id="tab4">4. RECORD</div>
</div>
<div class="center-content" id="centerContent">
<div class="welcome" id="welcomeScreen">
<div class="welcome-emoji">üß¨üî¨üèîÔ∏è</div>
<div class="welcome-title">Investigate 8 Real Genetic Cases</div>
<div class="welcome-sub">Real people's lives were changed forever by their genetic code ‚Äî and scientists can prove it.<br><br>Pick a scenario from the left to start your investigation.</div>
</div>
</div>
<div class="action-row">
<button class="action-btn hidden" id="actionBtn" onclick="handleAction()">Begin</button>
<button class="read-aloud-btn hidden" id="readAloudBtn" onclick="toggleReadAloud()">üîä Read Aloud</button>
</div>
</div>

<!-- RIGHT SIDEBAR -->
<div class="right-sb">
<div class="progress-header">Progress</div>
<div class="hud-grid">
<div class="hud-item"><div class="hud-val score" id="hudScore">0</div><div class="hud-label">Score</div></div>
<div class="hud-item"><div class="hud-val streak" id="hudStreak">0</div><div class="hud-label">Streak</div></div>
<div class="hud-item"><div class="hud-val completed" id="hudCompleted">0</div><div class="hud-label">Completed</div></div>
<div class="hud-item"><div class="hud-val accuracy" id="hudAccuracy">‚Äî</div><div class="hud-label">Accuracy</div></div>
</div>
<div class="progress-bar-wrap">
<div class="progress-bar-outer"><div class="progress-bar-inner" id="progressBar"></div></div>
</div>
<div class="progress-status" id="progressStatus">Pick 5 more you like!</div>
<div class="divider" style="margin:6px 14px;"></div>
<div class="data-header"><span>Data Table</span><button class="copy-btn" id="copyBtn" onclick="copyTable()">üìã Copy Table</button></div>
<div class="data-table-wrap">
<table class="data-table">
<thead><tr><th>Scenario</th><th>What Happened?</th><th>Response</th><th>Genetics?</th></tr></thead>
<tbody id="dataBody"></tbody>
</table>
</div>
</div>
</div>

<div class="completion-banner hidden" id="completionBanner">
<h2 id="bannerTitle">üéâ Required Complete!</h2>
<p id="bannerMsg">You finished 5 scenarios! Continue for Extra Credit?</p>
<button class="close-banner" onclick="closeBanner()">Keep Going!</button>
</div>

<script>
// ============ DATA ============
const KEY_WORDS = ['gene','trait','DNA','inherit','genetic code','mutation','offspring'];

const SCENARIOS = [
{id:1,name:"Olympic Skier's Superblood",emoji:'üéø',gaugePos:85,
low:{text:`Eero M√§ntyranta wins the 1964 Olympic ski race by 40 seconds. People call him a cheater for 30 years. Scientists test his <span class="kw">DNA</span> and find a rare <span class="kw">gene</span> that makes his body produce far more red blood cells than normal. The extra cells carry more oxygen ‚Äî his <span class="kw">genetic code</span> gives him a built-in <span class="kw">trait</span> no training can match.`,keywords:['DNA','gene','genetic code','trait']},
med:{text:`Eero M√§ntyranta crosses the finish line 40 seconds ahead of everyone at the 1964 Winter Olympics. For three decades, people accuse him of cheating. Scientists finally test his <span class="kw">DNA</span> and discover a rare <span class="kw">mutation</span> in his EPOR <span class="kw">gene</span>. This <span class="kw">gene</span> tells his body to keep producing red blood cells far beyond normal levels. His blood carries 25‚Äì50% more oxygen than the average person. When scientists test 97 family members, they find 29 carry the same <span class="kw">gene</span> ‚Äî his niece and nephew both become champion skiers who <span class="kw">inherited</span> the same <span class="kw">trait</span>.`,keywords:['DNA','mutation','gene','inherit','trait']},
high:{text:`Eero M√§ntyranta grows up in extreme poverty in Finland. He skis across a frozen lake just to get to school. At the 1964 Olympics, he wins the 15 km race by 40.7 seconds ‚Äî the biggest margin in Olympic cross-country skiing history. People accuse him of cheating for 30 years. Scientists finally test his <span class="kw">DNA</span> and find a rare <span class="kw">mutation</span> in a <span class="kw">gene</span> called EPOR that locks his red blood cell production on high. His blood carries 25‚Äì50% more oxygen than an average person ‚Äî a massive advantage his <span class="kw">genetic code</span> gave him at birth. Scientists test 97 members of his family across five generations and find 29 carry the exact same <span class="kw">gene</span>. His niece becomes a national champion and his nephew wins an Olympic medal ‚Äî both <span class="kw">inherited</span> the same <span class="kw">trait</span> through their <span class="kw">DNA</span>.`,keywords:['DNA','mutation','gene','genetic code','inherit','trait']},
predict:'What gave this Olympic skier such a huge advantage?',
predictOpts:['Hard training','Special diet','A gene in his DNA','Better equipment'],
dataRow:["Olympic Skier's Superblood","Rare EPOR gene made extra red blood cells","Body carried 50% more oxygen ‚Äî won by 40 sec","Gene inherited ‚Äî 29 family members carry same trait"],
watchDesc:'skier-blood'
},
{id:2,name:"The Sprint Gene",emoji:'üèÉ',gaugePos:50,
low:{text:`Scientists discover a <span class="kw">gene</span> called ACTN3 ‚Äî the "speed gene." This <span class="kw">gene</span> controls whether your muscles are built for sprinting or long runs. Every Olympic sprinter tested has at least one working copy. Your muscle type is a <span class="kw">trait</span> written in your <span class="kw">DNA</span> before you ever start training.`,keywords:['gene','trait','DNA']},
med:{text:`Scientists discover a <span class="kw">gene</span> called ACTN3 that makes a protein found only in fast-twitch muscle fibers. About 18% of people worldwide are missing this protein entirely. When scientists test Olympic sprinters, they find something shocking ‚Äî zero sprinters are missing both copies of the <span class="kw">gene</span>. A company starts selling $149 <span class="kw">DNA</span> tests to parents claiming it can predict their child's best sport. But scientists warn that one <span class="kw">gene</span> does not decide everything ‚Äî the ACTN3 <span class="kw">trait</span> gives a starting point, not a finish line.`,keywords:['gene','DNA','trait']},
high:{text:`Scientists discover a <span class="kw">gene</span> called ACTN3 that builds a protein found in fast-twitch muscle fibers ‚Äî the fibers that fire during explosive sprints. About 18% of people worldwide carry two broken copies and produce none of this protein. Researchers test hundreds of elite athletes and find something dramatic ‚Äî zero Olympic sprinters have two missing copies of ACTN3. Meanwhile, endurance athletes are more likely to be missing the <span class="kw">gene</span> entirely. A company begins selling $149 <span class="kw">DNA</span> tests to parents, promising to predict which sport their child should play. Scientists push back hard ‚Äî they say one <span class="kw">gene</span> does not decide athletic destiny. But the data is clear: your <span class="kw">genetic code</span> sets a starting point, and this <span class="kw">trait</span> ‚Äî fast-twitch vs. slow-twitch ‚Äî is something you <span class="kw">inherit</span> before your first practice.`,keywords:['gene','DNA','genetic code','trait','inherit']},
predict:'What determines if your muscles are built for speed?',
predictOpts:['How much you train','The food you eat','A gene in your DNA','Your shoe type'],
dataRow:["The Sprint Gene","ACTN3 gene controls fast-twitch muscle fibers","0% of Olympic sprinters missing this gene","Gene sets starting point ‚Äî trait inherited through DNA"],
watchDesc:'sprint-muscle'
},
{id:3,name:"One Gene, Two Fates",emoji:'ü©∏',gaugePos:88,
low:{text:`In parts of Africa, one <span class="kw">gene</span> change in the blood can save your life ‚Äî or make it much harder. Parents can pass this <span class="kw">gene</span> to their <span class="kw">offspring</span> without knowing. If a child <span class="kw">inherits</span> one copy from one parent, malaria parasites cannot grow well in their blood. If they <span class="kw">inherit</span> two copies, they develop sickle cell disease with painful episodes.`,keywords:['gene','offspring','inherit']},
med:{text:`Scientists estimate that roughly 20,000 years ago, a <span class="kw">mutation</span> appeared in a <span class="kw">gene</span> that controls hemoglobin ‚Äî the molecule in red blood cells that carries oxygen. In parts of Africa where malaria kills thousands, this one <span class="kw">gene</span> change became a matter of life and death. If you <span class="kw">inherit</span> one copy from one parent, your blood fights off malaria parasites ‚Äî you are protected. If you <span class="kw">inherit</span> two copies ‚Äî one from each parent ‚Äî your red blood cells bend into a sickle shape and get stuck in blood vessels, causing sickle cell disease. The same <span class="kw">DNA</span> change creates two completely different <span class="kw">traits</span> depending on how many copies you receive.`,keywords:['mutation','gene','inherit','DNA','trait']},
high:{text:`Scientists estimate that roughly 20,000 years ago, a single <span class="kw">mutation</span> appeared in the <span class="kw">gene</span> that builds hemoglobin ‚Äî the molecule inside red blood cells that carries oxygen. This tiny change in the <span class="kw">genetic code</span> would reshape millions of lives across Africa. In regions where malaria kills thousands every year, people who <span class="kw">inherit</span> one copy of this changed <span class="kw">gene</span> from one parent gain powerful protection ‚Äî malaria parasites cannot grow well inside their blood cells. But people who <span class="kw">inherit</span> two copies ‚Äî one from each parent ‚Äî develop sickle cell disease. Their red blood cells bend into stiff crescent shapes that clog blood vessels and cause intense pain. Scientists estimate that roughly 80% of people born with sickle cell disease live in sub-Saharan Africa. The same <span class="kw">mutation</span> in the same <span class="kw">DNA</span> creates two completely different <span class="kw">traits</span>: one copy protects you, two copies can change your entire life.`,keywords:['mutation','gene','genetic code','inherit','DNA','trait']},
predict:'Can one gene change have two completely different effects?',
predictOpts:['No ‚Äî one gene = one result','Yes ‚Äî it depends on copies','Only if you are sick','It depends on age'],
dataRow:["One Gene, Two Fates","Hemoglobin gene mutation affects blood cells","1 copy = malaria protection, 2 copies = sickle cell","Same gene inherited differently = two different traits"],
watchDesc:'sickle-cell'
},
{id:4,name:"Twins Who Grew Apart",emoji:'üëØ',gaugePos:18,
low:{text:`Scientists study 80 pairs of identical twins ‚Äî same <span class="kw">DNA</span>, same starting point. Young twins are almost impossible to tell apart genetically. But 35% of older twin pairs show big differences in which <span class="kw">genes</span> are active. The twins who lived the most different lives changed the most ‚Äî same <span class="kw">genetic code</span>, different outcomes.`,keywords:['DNA','gene','genetic code']},
med:{text:`Scientists study 80 pairs of identical twins who share the exact same <span class="kw">DNA</span>. When the twins are young, their <span class="kw">genes</span> are nearly impossible to tell apart. But when scientists test older twins, 35% show major differences in which <span class="kw">genes</span> are switched on or off inside their cells. The twins who spent the most time apart and had different diets, habits, and lifestyles show the biggest changes. Same <span class="kw">genetic code</span> at birth ‚Äî but their environments reshaped which <span class="kw">traits</span> actually appeared. This shows <span class="kw">DNA</span> matters, but choices matter too ‚Äî your environment can change how your <span class="kw">genes</span> work.`,keywords:['DNA','gene','genetic code','trait']},
high:{text:`Scientists in Spain study 80 pairs of identical twins ‚Äî people who started life with the exact same <span class="kw">DNA</span> in every cell. When the twins are young, their <span class="kw">genes</span> work almost identically. But something changes over time. Among older twin pairs, 35% show major differences in which <span class="kw">genes</span> are switched on or off inside their cells. The differences in active <span class="kw">genes</span> among older twins are four times greater than among young twins. The twins who spent the most time apart and had the most different diets, habits, and lifestyles show the biggest genetic changes. This means your <span class="kw">genetic code</span> is not a locked fate ‚Äî the environment you live in can change which <span class="kw">traits</span> your <span class="kw">DNA</span> actually produces. Same <span class="kw">genes</span> at birth, different lives, different outcomes.`,keywords:['DNA','gene','genetic code','trait']},
predict:'If identical twins have the same DNA, will they always stay the same?',
predictOpts:['Yes ‚Äî same DNA = same life','No ‚Äî lifestyle can change genes','Only their looks change','Twins never change'],
dataRow:["Twins Who Grew Apart","35% of older twins had different active genes","Different lifestyles changed which genes turned on/off","Same DNA but environment changed which traits appeared"],
watchDesc:'twins'
},
{id:5,name:"The DNA Surprise",emoji:'üß¨',gaugePos:78,
low:{text:`Katherine Valerio always looks different from her siblings ‚Äî darker hair and darker features while most of them are blonde. As an adult, she takes a <span class="kw">DNA</span> test and discovers her ancestry is very different from what she expected. When she connects with relatives matched through <span class="kw">DNA</span>, they share her physical <span class="kw">traits</span>. Her <span class="kw">genetic code</span> finally explains features that made her stand out her whole life.`,keywords:['DNA','trait','genetic code']},
med:{text:`Katherine Valerio grows up noticing she looks different from many of her siblings. They are mostly blonde with lighter skin, while she has darker hair and darker features. She wonders about it for years but has no answers. As an adult, Katherine takes a <span class="kw">DNA</span> test and discovers a large portion of her ancestry traces to Egypt ‚Äî not what her family expected. When the test connects her to relatives she never knew, those relatives share her exact physical <span class="kw">traits</span>. Her <span class="kw">DNA</span> carries a <span class="kw">genetic code</span> that shaped her appearance from birth ‚Äî and a simple test finally made the connection visible. The <span class="kw">traits</span> she always noticed were ones she <span class="kw">inherited</span> all along.`,keywords:['DNA','trait','genetic code','inherit']},
high:{text:`Katherine Valerio spends her whole childhood noticing she looks physically different from many of her siblings. Most of them have blonde hair and lighter skin, while Katherine has darker hair and darker features. She never has an explanation. As an adult, she takes a <span class="kw">DNA</span> test and the results shock her ‚Äî a large portion of her ancestry traces to Egypt, not Portugal as she expected. The <span class="kw">genes</span> she carries came from a different background than most of her siblings. When the <span class="kw">DNA</span> test connects her to relatives she never knew existed, she notices something powerful: they share her exact physical <span class="kw">traits</span> ‚Äî the same features that always made her stand out. Her <span class="kw">genetic code</span> shaped her appearance from the very first cell, and those <span class="kw">traits</span> were <span class="kw">inherited</span> through a lineage she did not discover until adulthood.`,keywords:['DNA','gene','trait','genetic code','inherit']},
predict:'Why did Katherine look so different from her siblings?',
predictOpts:['She ate different food','Different genes from ancestry','She dyed her hair','The sun changed her skin'],
dataRow:["The DNA Surprise","DNA test revealed unexpected Egyptian ancestry","Matched relatives shared her exact physical traits","Traits inherited through genetic code from different lineage"],
watchDesc:'dna-surprise'
},
{id:6,name:"Can't Drink Milk",emoji:'ü•õ',gaugePos:82,
low:{text:`About 65% of people in the world cannot digest milk as adults. Their bodies stop making an enzyme called lactase after childhood ‚Äî and a <span class="kw">gene</span> controls when it shuts off. Scientists tested 7,000-year-old bones from ancient Europeans and found zero had the <span class="kw">mutation</span> for milk tolerance. Whether you can drink milk as an adult is a <span class="kw">trait</span> locked in your <span class="kw">DNA</span>.`,keywords:['gene','mutation','trait','DNA']},
med:{text:`About 65% of people in the world cannot digest milk once they grow past childhood. A <span class="kw">gene</span> in your <span class="kw">DNA</span> controls the production of lactase ‚Äî the enzyme that breaks down milk sugar. In most people, this <span class="kw">gene</span> switches off after childhood, making milk hard to digest. Scientists tested 7,000-year-old bones from ancient Europeans and found zero had the <span class="kw">mutation</span> that keeps lactase running. Scientists estimate the milk-tolerance <span class="kw">mutation</span> became common roughly 7,500 years ago, after humans began farming cattle. Whether your body can handle milk as an adult is an <span class="kw">inherited</span> <span class="kw">trait</span> ‚Äî your <span class="kw">genetic code</span> decided it before you ever drank a glass.`,keywords:['gene','DNA','mutation','inherit','trait','genetic code']},
high:{text:`About 65% of adults worldwide get sick when they drink milk. The reason is written in their <span class="kw">DNA</span>. A <span class="kw">gene</span> controls the production of lactase ‚Äî the enzyme your body uses to break down lactose, the sugar in milk. In most people, this <span class="kw">gene</span> switches off sometime after childhood, and their bodies stop making enough lactase to handle dairy. Scientists tested 7,000-year-old bones from ancient Europeans and found that zero out of nine individuals carried the <span class="kw">mutation</span> for lactose tolerance. Scientists estimate this <span class="kw">mutation</span> became common roughly 7,500 years ago, after humans began farming cattle ‚Äî people who could digest milk had a survival advantage and passed that <span class="kw">trait</span> to their <span class="kw">offspring</span>. Today, about 35% of adults worldwide can still drink milk comfortably. Whether you are in that 35% or the other 65% is an <span class="kw">inherited</span> <span class="kw">trait</span> decided by your <span class="kw">genetic code</span>.`,keywords:['DNA','gene','mutation','trait','offspring','inherit','genetic code']},
predict:'Why can some adults drink milk but others get sick?',
predictOpts:['Allergies from food','A gene that turns off','They never tried milk','Stomach size difference'],
dataRow:["Can't Drink Milk","Gene for lactase enzyme shuts off after childhood","65% of adults can't digest milk ‚Äî 0/9 ancient had mutation","Milk tolerance is an inherited trait in DNA"],
watchDesc:'milk-lactase'
},
{id:7,name:"Built for Thin Air",emoji:'üèîÔ∏è',gaugePos:72,
low:{text:`Tibetan people live at 14,000+ feet where most visitors get dangerously sick from low oxygen. Scientists find that Tibetans carry a <span class="kw">gene</span> variant called EPAS1 that lets them thrive with less hemoglobin in their blood. Most people at high altitude make too many red blood cells, which thickens their blood and causes problems. This <span class="kw">trait</span> is written in Tibetan <span class="kw">DNA</span> ‚Äî their <span class="kw">genetic code</span> matches their mountain environment.`,keywords:['gene','trait','DNA','genetic code']},
med:{text:`Tibetan people have lived at 14,000+ feet for thousands of years ‚Äî altitudes where most visitors collapse from lack of oxygen. Scientists discover they carry a variant of a <span class="kw">gene</span> called EPAS1 that changes how their bodies handle thin air. Most people at high altitude overproduce red blood cells, thickening their blood and causing chronic mountain sickness. Tibetans do the opposite ‚Äî their <span class="kw">gene</span> variant keeps hemoglobin levels low so their blood flows smoothly. Scientists estimate this <span class="kw">gene</span> variant became more common in Tibetan populations over roughly 3,000 years because it helped people survive at extreme altitude. This <span class="kw">trait</span> is <span class="kw">inherited</span> through <span class="kw">DNA</span> ‚Äî Tibetan children are born ready for thin air.`,keywords:['gene','trait','inherit','DNA']},
high:{text:`Tibetan people have thrived above 14,000 feet for thousands of years in conditions that make most visitors dangerously ill. At extreme altitude, the air holds far less oxygen, and the human body typically responds by flooding the bloodstream with extra red blood cells. But this response backfires ‚Äî thick blood leads to chronic mountain sickness, blood clots, and organ damage. Scientists discover that Tibetans carry a variant of a <span class="kw">gene</span> called EPAS1 that does the opposite. This <span class="kw">gene</span> variant keeps their hemoglobin levels low, allowing their blood to flow smoothly even in thin air. Scientists estimate this variant became more common in the Tibetan population over roughly 3,000 years because people who carried it survived and had more <span class="kw">offspring</span> at high altitude. This is a measurable change in how common a <span class="kw">gene</span> variant is within a population ‚Äî a clear example of a <span class="kw">trait</span> becoming more frequent because it matched the environment. Tibetan children <span class="kw">inherit</span> this advantage through their <span class="kw">DNA</span> and are born ready for the mountains.`,keywords:['gene','offspring','trait','inherit','DNA']},
predict:'How do Tibetan people survive where most visitors collapse?',
predictOpts:['They train harder','A gene variant in DNA','They eat special food','Thicker clothing'],
dataRow:["Built for Thin Air","EPAS1 gene keeps hemoglobin low for smooth blood flow","Tibetans thrive at 14,000 ft where visitors get sick","Trait inherited over ~3,000 years through DNA"],
watchDesc:'tibetan-altitude'
},
{id:8,name:"The Ancient Mother",emoji:'üèõÔ∏è',gaugePos:90,
low:{text:`In a cave in southern Italy, scientists find two people buried together more than 12,000 years ago ‚Äî one holding the other. Ancient <span class="kw">DNA</span> proves they are mother and daughter. The daughter carries two copies of a changed <span class="kw">gene</span> that causes a rare bone disorder. Despite serious physical challenges, the daughter survived into her teens ‚Äî her community must have cared for her.`,keywords:['DNA','gene']},
med:{text:`Deep inside a cave in southern Italy, scientists uncover two people buried together more than 12,000 years ago. One figure holds the other in an embrace that lasted thousands of years. Scientists extract ancient <span class="kw">DNA</span> from their bones and confirm they are mother and daughter. The daughter ‚Äî the mother's <span class="kw">offspring</span> ‚Äî carries two copies of a changed <span class="kw">gene</span> called NPR2, a <span class="kw">mutation</span> that causes a rare bone-growth disorder and made her significantly shorter than average. Despite serious physical challenges, she survived into her teens or adulthood ‚Äî meaning her community must have supported her. Her condition was an <span class="kw">inherited</span> <span class="kw">trait</span> written in her <span class="kw">DNA</span> from birth.`,keywords:['DNA','offspring','gene','mutation','inherit','trait']},
high:{text:`In Romito Cave in southern Italy, scientists uncover two ancient people buried together more than 12,000 years ago. One figure cradles the other ‚Äî an embrace that has lasted since before the first cities existed. Scientists extract ancient <span class="kw">DNA</span> from the bones and confirm they are mother and daughter. The daughter carries two copies of a <span class="kw">mutation</span> in a <span class="kw">gene</span> called NPR2, which causes acromesomelic dysplasia ‚Äî a rare bone-growth disorder. She stands roughly 110 cm tall, compared to her mother at about 145 cm. The condition caused serious physical challenges throughout her life. Yet the daughter survived into her teens or even adulthood ‚Äî a fact that stuns researchers because it means her ancient community provided sustained care and support. Her bone disorder was an <span class="kw">inherited</span> <span class="kw">trait</span> coded into her <span class="kw">DNA</span> from the moment she was conceived, passed down because both parents carried one copy of the changed <span class="kw">gene</span>.`,keywords:['DNA','mutation','gene','inherit','trait']},
predict:'What can 12,000-year-old bones tell us about genetics?',
predictOpts:['Nothing ‚Äî too old','DNA reveals family links','Only their age','What they ate'],
dataRow:["The Ancient Mother","Ancient DNA confirmed mother-daughter burial","Daughter inherited bone disorder gene ‚Äî community cared for her","2 copies of changed gene = inherited trait from both parents"],
watchDesc:'ancient-burial'
}
];

// ============ STATE ============
let state = {
currentScenario: null,
step: null, // predict, read, watch, record, null
readingLevel: 'low',
completedIds: [],
score: 0,
streak: 0,
predictions: {},
speechActive: false,
speechResumeInterval: null,
dataRows: []
};

// ============ INIT ============
function init(){
try{
renderScenarioCards();
renderKeyWords();
updateHUD();
}catch(e){console.error('Init error:',e);}
}

function renderScenarioCards(){
const list = document.getElementById('scenarioList');
list.innerHTML = '';
SCENARIOS.forEach(s=>{
const card = document.createElement('div');
card.className = 'scenario-card' + (state.completedIds.includes(s.id)?' completed':'') + (state.currentScenario===s.id?' selected':'');
card.innerHTML = `<span class="sc-emoji">${s.emoji}</span><span class="sc-name">${s.name}</span>`;
card.onclick = ()=> selectScenario(s.id);
list.appendChild(card);
});
}

function renderKeyWords(){
const list = document.getElementById('kwList');
list.innerHTML = '';
KEY_WORDS.forEach(w=>{
const tag = document.createElement('span');
tag.className = 'kw-tag';
tag.textContent = w;
tag.dataset.word = w;
list.appendChild(tag);
});
}

function highlightKeyWords(keywords){
document.querySelectorAll('.kw-tag').forEach(t=>{
const w = t.dataset.word;
t.classList.toggle('highlighted', keywords.some(k=>w.toLowerCase().includes(k.toLowerCase())||k.toLowerCase().includes(w.toLowerCase())));
});
}

// ============ SCENARIO SELECTION ============
function selectScenario(id){
try{
if(state.step==='watch') return;
stopSpeech();
state.currentScenario = id;
state.step = 'predict';
renderScenarioCards();
const s = SCENARIOS.find(x=>x.id===id);
highlightKeyWords(s[state.readingLevel].keywords);
showPredict(s);
updateTabs();
}catch(e){console.error('Select error:',e);}
}

function setReadingLevel(level){
state.readingLevel = level;
document.querySelectorAll('.rl-tab').forEach(t=>t.classList.toggle('active',t.dataset.level===level));
if(state.step==='read' && state.currentScenario){
const s = SCENARIOS.find(x=>x.id===state.currentScenario);
showRead(s);
}
}

// ============ STEP DISPLAYS ============
function showPredict(s){
const cc = document.getElementById('centerContent');
cc.innerHTML = `<div class="content-card predict-area">
<div class="predict-emoji">${s.emoji}</div>
<div class="predict-title">${s.name}</div>
<div class="predict-q">${s.predict}</div>
<div class="predict-btns">${s.predictOpts.map((o,i)=>`<button class="predict-btn" onclick="makePrediction(${s.id},${i})">${o}</button>`).join('')}</div>
</div>`;
document.getElementById('actionBtn').classList.add('hidden');
document.getElementById('readAloudBtn').classList.add('hidden');
}

function makePrediction(id, idx){
try{
state.predictions[id] = idx;
state.step = 'read';
const s = SCENARIOS.find(x=>x.id===id);
showRead(s);
updateTabs();
}catch(e){console.error('Predict error:',e);}
}

function showRead(s){
const level = state.readingLevel;
const passage = s[level].text;
const cc = document.getElementById('centerContent');
cc.innerHTML = `<div class="content-card read-area">
<div class="read-title">${s.emoji} ${s.name}</div>
<div class="passage-box" id="passageBox">${passage}</div>
</div>`;
const btn = document.getElementById('actionBtn');
btn.classList.remove('hidden');
btn.textContent = 'I Finished Reading ‚Üí';
btn.disabled = false;
const rab = document.getElementById('readAloudBtn');
rab.classList.remove('hidden');
rab.classList.remove('reading');
rab.textContent = 'üîä Read Aloud';
}

function showWatch(s){
const cc = document.getElementById('centerContent');
cc.innerHTML = `<div class="content-card watch-area">
<div class="watch-title">üî¨ Watching: ${s.name}</div>
<div class="arena" id="arenaBox">
<div class="arena-content" id="arenaContent"></div>
<div class="gauge-container">
<div class="gauge-track"><div class="gauge-indicator" id="gaugeIndicator" style="left:50%"></div></div>
<div class="gauge-labels"><span>Mostly Environment</span><span>Balanced</span><span>Mostly Genes</span></div>
</div>
</div>
</div>`;
const btn = document.getElementById('actionBtn');
btn.classList.remove('hidden');
btn.textContent = 'Recording...';
btn.disabled = true;
document.getElementById('readAloudBtn').classList.add('hidden');
setTimeout(()=>{try{runWatchAnimation(s);}catch(e){console.error('Watch anim error:',e);finishWatch();}},300);
}

function showRecord(s){
const cc = document.getElementById('centerContent');
const remaining = 5 - state.completedIds.length;
const msg = remaining > 0 ? `${remaining} more to go!` : state.completedIds.length < 8 ? 'Keep going for Extra Credit!' : 'All 8 complete!';
cc.innerHTML = `<div class="content-card record-area">
<div class="record-emoji">‚úÖ</div>
<div class="record-msg">Data Recorded!</div>
<div class="record-sub">${msg} Pick your next scenario.</div>
</div>`;
document.getElementById('actionBtn').classList.add('hidden');
document.getElementById('readAloudBtn').classList.add('hidden');
}

// ============ ACTION HANDLER ============
function handleAction(){
try{
const s = SCENARIOS.find(x=>x.id===state.currentScenario);
if(!s) return;
if(state.step==='read'){
stopSpeech();
state.step = 'watch';
updateTabs();
showWatch(s);
}
}catch(e){console.error('Action error:',e);}
}

function finishWatch(){
try{
const s = SCENARIOS.find(x=>x.id===state.currentScenario);
if(!s) return;
if(!state.completedIds.includes(s.id)){
state.completedIds.push(s.id);
state.score += 100;
state.streak++;
state.dataRows.push(s.dataRow);
addDataRow(s.dataRow);
}
state.step = 'record';
updateTabs();
updateHUD();
renderScenarioCards();
showRecord(s);
spawnParticles();
if(state.completedIds.length===5) showBanner('required');
else if(state.completedIds.length===8) showBanner('extra');
}catch(e){console.error('Finish watch error:',e);}
}

// ============ WATCH ANIMATIONS ============
function runWatchAnimation(s){
const arena = document.getElementById('arenaContent');
const gauge = document.getElementById('gaugeIndicator');
if(!arena||!gauge) {finishWatch();return;}
// Build scenario-specific arena visual
arena.innerHTML = buildArenaVisual(s);
// Animate gauge
setTimeout(()=>{gauge.style.left = s.gaugePos+'%';
gauge.style.boxShadow = s.gaugePos>60?'0 0 20px rgba(66,165,245,.8)':s.gaugePos<40?'0 0 20px rgba(253,216,53,.8)':'0 0 20px rgba(102,187,106,.8)';
},400);
// Auto finish after animation
setTimeout(()=>{finishWatch();},4500);
}

function buildArenaVisual(s){
const id = s.watchDesc;
const base = 'position:absolute;transition:all 1s;';
switch(id){
case 'skier-blood': return `
<div style="${base}left:50%;top:20%;transform:translateX(-50%);text-align:center;">
<div style="font-size:60px;animation:pulse 1.5s infinite;">üéø</div>
<div style="font-size:12px;color:#80cbc4;margin-top:4px;font-weight:700;">Eero M√§ntyranta</div>
</div>
<div style="${base}left:15%;top:30%;width:30%;text-align:center;">
<div style="font-size:10px;color:#ef5350;font-weight:700;margin-bottom:4px;">Gene: EPOR</div>
<div style="display:flex;gap:2px;justify-content:center;flex-wrap:wrap;" id="bloodCells"></div>
<div style="font-size:9px;color:#aaa;margin-top:4px;">Red Blood Cells</div>
</div>
<div style="${base}right:15%;top:25%;width:25%;text-align:center;">
<div style="font-size:10px;color:#42a5f5;font-weight:700;margin-bottom:4px;">Oxygen Level</div>
<div style="width:100%;height:120px;background:rgba(255,255,255,.05);border-radius:8px;position:relative;overflow:hidden;border:1px solid rgba(66,165,245,.2);">
<div id="oxyBar" style="position:absolute;bottom:0;width:100%;height:50%;background:linear-gradient(0deg,#42a5f5,#90caf9);transition:height 2s;border-radius:0 0 8px 8px;"></div>
<div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:20px;font-weight:800;color:#fff;z-index:2;text-shadow:0 2px 8px rgba(0,0,0,.5);" id="oxyPct">100%</div>
</div>
</div>
<div style="${base}bottom:10px;left:50%;transform:translateX(-50%);display:flex;gap:6px;align-items:center;" id="familyTree">
<div style="font-size:9px;color:#b388ff;font-weight:700;">Family: </div>
</div>
<style>@keyframes pulse{0%,100%{transform:translateX(-50%) scale(1);}50%{transform:translateX(-50%) scale(1.1);}}</style>
<script>
setTimeout(()=>{try{
const bc=document.getElementById('bloodCells');if(bc){for(let i=0;i<20;i++){const d=document.createElement('div');d.style.cssText='width:8px;height:8px;border-radius:50%;background:#ef5350;animation:cellPop .5s '+(i*80)+'ms both;';bc.appendChild(d);}}
const ob=document.getElementById('oxyBar');if(ob)ob.style.height='85%';
const op=document.getElementById('oxyPct');if(op){let v=100;const iv=setInterval(()=>{v+=2;if(v>=150){clearInterval(iv);}op.textContent=v+'%';},60);}
const ft=document.getElementById('familyTree');if(ft){for(let i=0;i<8;i++){setTimeout(()=>{const d=document.createElement('div');d.style.cssText='width:12px;height:12px;border-radius:50%;background:'+(i<4?'#42a5f5':'#90a4ae')+';transition:all .3s;';ft.appendChild(d);},500+i*150);}}
}catch(e){}}
,200);
<\/script>`;

case 'sprint-muscle': return `
<div style="${base}left:20%;top:15%;text-align:center;width:25%;">
<div style="font-size:48px;">üèÉ‚Äç‚ôÇÔ∏è</div>
<div style="font-size:11px;color:#ef5350;font-weight:700;">Sprinter</div>
<div style="margin-top:6px;width:100%;height:80px;background:rgba(239,83,80,.1);border-radius:8px;border:1px solid rgba(239,83,80,.2);display:flex;flex-direction:column;justify-content:flex-end;padding:4px;overflow:hidden;">
<div id="fastTwitch" style="width:100%;background:linear-gradient(0deg,#ef5350,#e57373);border-radius:4px;transition:height 2s;height:20%;"></div>
</div>
<div style="font-size:9px;color:#ef5350;margin-top:2px;">Fast-Twitch</div>
</div>
<div style="${base}left:50%;top:10%;transform:translateX(-50%);text-align:center;">
<div style="font-size:11px;color:#b388ff;font-weight:700;background:rgba(179,136,255,.1);padding:6px 16px;border-radius:20px;border:1px solid rgba(179,136,255,.2);">Gene: ACTN3</div>
<div style="margin-top:8px;font-size:40px;">üß¨</div>
<div style="margin-top:4px;font-size:9px;color:#888;">0% of sprinters missing</div>
</div>
<div style="${base}right:20%;top:15%;text-align:center;width:25%;">
<div style="font-size:48px;">üèÉ</div>
<div style="font-size:11px;color:#42a5f5;font-weight:700;">Endurance</div>
<div style="margin-top:6px;width:100%;height:80px;background:rgba(66,165,245,.1);border-radius:8px;border:1px solid rgba(66,165,245,.2);display:flex;flex-direction:column;justify-content:flex-end;padding:4px;overflow:hidden;">
<div id="slowTwitch" style="width:100%;background:linear-gradient(0deg,#42a5f5,#90caf9);border-radius:4px;transition:height 2s;height:20%;"></div>
</div>
<div style="font-size:9px;color:#42a5f5;margin-top:2px;">Slow-Twitch</div>
</div>
<script>setTimeout(()=>{try{const f=document.getElementById('fastTwitch');if(f)f.style.height='85%';const s=document.getElementById('slowTwitch');if(s)s.style.height='60%';}catch(e){}},500);<\/script>`;

case 'sickle-cell': return `
<div style="${base}left:50%;top:5%;transform:translateX(-50%);text-align:center;">
<div style="font-size:10px;color:#ffab40;font-weight:700;padding:4px 14px;background:rgba(255,171,64,.1);border-radius:12px;border:1px solid rgba(255,171,64,.2);">Same Gene ‚Äî Two Fates</div>
</div>
<div style="${base}left:5%;top:25%;width:42%;text-align:center;">
<div style="font-size:11px;color:#66bb6a;font-weight:700;margin-bottom:4px;">1 Copy = Protected</div>
<div style="font-size:32px;">üõ°Ô∏è</div>
<div style="display:flex;gap:3px;justify-content:center;margin-top:6px;" id="healthyCells"></div>
<div style="font-size:9px;color:#888;margin-top:4px;">Round blood cells block parasites</div>
</div>
<div style="${base}left:50%;top:35%;width:2px;height:60px;background:rgba(255,255,255,.1);"></div>
<div style="${base}right:5%;top:25%;width:42%;text-align:center;">
<div style="font-size:11px;color:#ef5350;font-weight:700;margin-bottom:4px;">2 Copies = Sickle Cell</div>
<div style="font-size:32px;">‚ö†Ô∏è</div>
<div style="display:flex;gap:3px;justify-content:center;margin-top:6px;" id="sickleCells"></div>
<div style="font-size:9px;color:#888;margin-top:4px;">Crescent cells clog vessels</div>
</div>
<script>setTimeout(()=>{try{
const h=document.getElementById('healthyCells');if(h){for(let i=0;i<6;i++){const d=document.createElement('div');d.style.cssText='width:14px;height:14px;border-radius:50%;background:#ef5350;animation:cellPop .4s '+(i*100)+'ms both;';h.appendChild(d);}}
const s=document.getElementById('sickleCells');if(s){for(let i=0;i<6;i++){const d=document.createElement('div');d.style.cssText='width:16px;height:10px;border-radius:40%;background:#c62828;transform:rotate('+(i%2?'15':'-15')+'deg);animation:cellPop .4s '+(i*100)+'ms both;';s.appendChild(d);}}
}catch(e){}},400);<\/script>
<style>@keyframes cellPop{0%{transform:scale(0);opacity:0;}100%{transform:scale(1);opacity:1;}}</style>`;

case 'twins': return `
<div style="${base}left:50%;top:5%;transform:translateX(-50%);text-align:center;">
<div style="font-size:10px;color:#fdd835;font-weight:700;padding:4px 14px;background:rgba(253,216,53,.1);border-radius:12px;border:1px solid rgba(253,216,53,.2);">Same DNA ‚Üí Different Lives</div>
</div>
<div style="${base}left:10%;top:22%;text-align:center;width:35%;">
<div style="font-size:48px;">üë§</div>
<div style="font-size:10px;color:#80cbc4;font-weight:700;">Twin A</div>
<div style="margin-top:6px;display:flex;gap:2px;justify-content:center;" id="dnaA"></div>
<div style="margin-top:6px;font-size:20px;" id="lifeA"></div>
</div>
<div style="${base}right:10%;top:22%;text-align:center;width:35%;">
<div style="font-size:48px;">üë§</div>
<div style="font-size:10px;color:#ff80ab;font-weight:700;">Twin B</div>
<div style="margin-top:6px;display:flex;gap:2px;justify-content:center;" id="dnaB"></div>
<div style="margin-top:6px;font-size:20px;" id="lifeB"></div>
</div>
<div style="${base}left:50%;bottom:20px;transform:translateX(-50%);font-size:14px;font-weight:800;color:#fdd835;" id="twinStat"></div>
<script>setTimeout(()=>{try{
const a=document.getElementById('dnaA'),b=document.getElementById('dnaB');
if(a&&b){for(let i=0;i<8;i++){
const da=document.createElement('div'),db=document.createElement('div');
const on=i<5;
da.style.cssText='width:10px;height:22px;border-radius:3px;transition:all 1s '+(i*200)+'ms;background:'+(on?'#66bb6a':'#66bb6a')+';';
db.style.cssText='width:10px;height:22px;border-radius:3px;transition:all 1s '+(i*200)+'ms;background:#66bb6a;';
a.appendChild(da);b.appendChild(db);
setTimeout(()=>{if(i>=5)db.style.background='#555';db.style.opacity=i>=5?'.4':'1';},1200);
}}
const la=document.getElementById('lifeA');if(la){setTimeout(()=>{la.textContent='ü•óüèÉüåø';},800);}
const lb=document.getElementById('lifeB');if(lb){setTimeout(()=>{lb.textContent='üçîüõãÔ∏èüéÆ';},800);}
const ts=document.getElementById('twinStat');if(ts){setTimeout(()=>{ts.textContent='35% Different Gene Activity';},1800);}
}catch(e){}},300);<\/script>`;

case 'dna-surprise': return `
<div style="${base}left:50%;top:8%;transform:translateX(-50%);text-align:center;">
<div style="font-size:36px;">üë©üèΩ</div>
<div style="font-size:11px;color:#b388ff;font-weight:700;">Katherine</div>
</div>
<div style="${base}left:10%;top:18%;text-align:center;width:20%;">
<div style="font-size:24px;">üë±‚Äç‚ôÄÔ∏èüë±üë±‚Äç‚ôÇÔ∏è</div>
<div style="font-size:9px;color:#888;margin-top:2px;">Siblings</div>
</div>
<div style="${base}left:50%;top:40%;transform:translateX(-50%);text-align:center;">
<div style="font-size:28px;animation:spin 3s linear infinite;">üß¨</div>
<div style="font-size:10px;color:#ffab40;font-weight:700;margin-top:4px;">DNA Test</div>
</div>
<div style="${base}left:50%;top:62%;transform:translateX(-50%);width:70%;text-align:center;">
<div style="font-size:9px;color:#80cbc4;font-weight:700;margin-bottom:4px;">Ancestry Revealed</div>
<div style="display:flex;justify-content:center;gap:6px;" id="ancestryBars"></div>
</div>
<div style="${base}right:10%;top:20%;text-align:center;width:20%;" id="matchedRels"></div>
<style>@keyframes spin{0%{transform:translateX(-50%) rotate(0);}100%{transform:translateX(-50%) rotate(360deg);}}</style>
<script>setTimeout(()=>{try{
const ab=document.getElementById('ancestryBars');if(ab){
['Egypt üá™üá¨','Portugal üáµüáπ','Other'].forEach((l,i)=>{const d=document.createElement('div');d.style.cssText='text-align:center;';d.innerHTML='<div style="width:30px;height:60px;background:rgba(255,255,255,.06);border-radius:4px;position:relative;overflow:hidden;margin:0 auto;"><div style="position:absolute;bottom:0;width:100%;height:0%;background:'+(i===0?'#42a5f5':i===1?'#66bb6a':'#ffab40')+';border-radius:0 0 4px 4px;transition:height 1.5s '+(i*300)+'ms;" id="ab'+i+'"></div></div><div style="font-size:8px;color:#aaa;margin-top:2px;">'+l+'</div>';ab.appendChild(d);});
setTimeout(()=>{const a0=document.getElementById('ab0');if(a0)a0.style.height='65%';const a1=document.getElementById('ab1');if(a1)a1.style.height='25%';const a2=document.getElementById('ab2');if(a2)a2.style.height='10%';},400);
}
const mr=document.getElementById('matchedRels');if(mr){setTimeout(()=>{mr.innerHTML='<div style="font-size:9px;color:#69f0ae;font-weight:700;margin-bottom:2px;">DNA Match!</div><div style="font-size:24px;">üë©üèΩüë®üèΩ</div><div style="font-size:8px;color:#888;">Shared traits</div>';},2000);}
}catch(e){}},400);<\/script>`;

case 'milk-lactase': return `
<div style="${base}left:50%;top:5%;transform:translateX(-50%);text-align:center;">
<div style="font-size:10px;color:#ffab40;font-weight:700;padding:4px 14px;background:rgba(255,171,64,.1);border-radius:12px;">Gene Switches Off After Childhood</div>
</div>
<div style="${base}left:10%;top:22%;width:35%;text-align:center;">
<div style="font-size:10px;color:#66bb6a;font-weight:700;">Child</div>
<div style="font-size:36px;">üë∂</div>
<div style="margin-top:4px;width:50px;height:50px;margin:4px auto;border-radius:50%;border:3px solid #66bb6a;display:flex;align-items:center;justify-content:center;"><span style="font-size:10px;color:#66bb6a;font-weight:700;">Lactase ‚úì</span></div>
<div style="font-size:18px;margin-top:4px;">ü•õ‚úÖ</div>
</div>
<div style="${base}right:10%;top:22%;width:35%;text-align:center;">
<div style="font-size:10px;color:#ef5350;font-weight:700;">Adult (65%)</div>
<div style="font-size:36px;">üßë</div>
<div style="margin-top:4px;width:50px;height:50px;margin:4px auto;border-radius:50%;border:3px solid #ef5350;display:flex;align-items:center;justify-content:center;"><span style="font-size:10px;color:#ef5350;font-weight:700;">Lactase ‚úó</span></div>
<div style="font-size:18px;margin-top:4px;">ü•õ‚ö†Ô∏è</div>
</div>
<div style="${base}left:50%;bottom:20px;transform:translateX(-50%);text-align:center;width:70%;">
<div style="font-size:9px;color:#80cbc4;font-weight:700;margin-bottom:4px;">Ancient Bones ‚Üí Today</div>
<div style="width:100%;height:14px;background:rgba(255,255,255,.06);border-radius:7px;overflow:hidden;position:relative;">
<div id="histBar" style="position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,#ef5350,#66bb6a);transition:width 2s;border-radius:7px;"></div>
</div>
<div style="display:flex;justify-content:space-between;font-size:8px;color:#888;margin-top:2px;"><span>7000 yrs: 0%</span><span>Today: 35%</span></div>
</div>
<script>setTimeout(()=>{try{const h=document.getElementById('histBar');if(h)h.style.width='35%';}catch(e){}},600);<\/script>`;

case 'tibetan-altitude': return `
<div style="${base}left:50%;top:3%;transform:translateX(-50%);text-align:center;">
<div style="font-size:10px;color:#42a5f5;font-weight:700;padding:4px 14px;background:rgba(66,165,245,.1);border-radius:12px;">14,000+ ft ‚Äî Gene: EPAS1</div>
</div>
<div style="${base}left:0;top:50%;width:100%;text-align:center;">
<div style="font-size:40px;">üèîÔ∏èüèîÔ∏èüèîÔ∏è</div>
</div>
<div style="${base}left:15%;top:18%;text-align:center;width:30%;">
<div style="font-size:36px;">üßë</div>
<div style="font-size:10px;color:#ef5350;font-weight:700;">Lowlander</div>
<div style="width:60px;height:8px;background:rgba(255,255,255,.06);border-radius:4px;margin:6px auto;overflow:hidden;"><div id="thickBlood" style="width:0%;height:100%;background:#ef5350;transition:width 2s;border-radius:4px;"></div></div>
<div style="font-size:8px;color:#ef5350;" id="lowLabel">Thick Blood</div>
</div>
<div style="${base}right:15%;top:18%;text-align:center;width:30%;">
<div style="font-size:36px;">üßë</div>
<div style="font-size:10px;color:#66bb6a;font-weight:700;">Tibetan</div>
<div style="width:60px;height:8px;background:rgba(255,255,255,.06);border-radius:4px;margin:6px auto;overflow:hidden;"><div id="smoothBlood" style="width:0%;height:100%;background:#66bb6a;transition:width 2s;border-radius:4px;"></div></div>
<div style="font-size:8px;color:#66bb6a;" id="tibLabel">Healthy Flow</div>
</div>
<div style="${base}left:50%;bottom:18px;transform:translateX(-50%);width:60%;text-align:center;">
<div style="font-size:9px;color:#b388ff;font-weight:700;">~3,000 Years of Selection</div>
<div style="display:flex;gap:2px;justify-content:center;margin-top:4px;" id="popDots"></div>
</div>
<script>setTimeout(()=>{try{
const tb=document.getElementById('thickBlood');if(tb)tb.style.width='95%';
const sb=document.getElementById('smoothBlood');if(sb)sb.style.width='45%';
const pd=document.getElementById('popDots');if(pd){for(let i=0;i<12;i++){const d=document.createElement('div');d.style.cssText='width:8px;height:8px;border-radius:50%;background:'+(i<3?'#555':i<7?'#7986cb':'#42a5f5')+';transition:all .5s '+(i*150)+'ms;';pd.appendChild(d);}}
}catch(e){}},500);<\/script>`;

case 'ancient-burial': return `
<div style="${base}left:50%;top:3%;transform:translateX(-50%);text-align:center;">
<div style="font-size:10px;color:#ffab40;font-weight:700;padding:4px 14px;background:rgba(255,171,64,.1);border-radius:12px;">12,000+ Years Ago ‚Äî Romito Cave</div>
</div>
<div style="${base}left:50%;top:25%;transform:translateX(-50%);text-align:center;">
<div style="font-size:48px;position:relative;">
<span style="position:relative;z-index:2;">ü§±</span>
<div style="position:absolute;top:-5px;left:-10px;right:-10px;bottom:-5px;background:radial-gradient(ellipse,rgba(255,171,64,.15),transparent);border-radius:50%;z-index:1;"></div>
</div>
<div style="font-size:10px;color:#ffab40;font-weight:700;margin-top:4px;">Mother & Daughter ‚Äî Confirmed</div>
</div>
<div style="${base}left:10%;top:55%;width:35%;text-align:center;">
<div style="font-size:10px;color:#80cbc4;font-weight:700;">Mother</div>
<div style="font-size:9px;color:#888;">~145 cm</div>
<div style="width:4px;height:58px;background:linear-gradient(0deg,#80cbc4,rgba(128,203,188,.3));margin:4px auto;border-radius:2px;"></div>
</div>
<div style="${base}right:10%;top:55%;width:35%;text-align:center;">
<div style="font-size:10px;color:#ef5350;font-weight:700;">Daughter</div>
<div style="font-size:9px;color:#888;">~110 cm</div>
<div style="width:4px;height:40px;background:linear-gradient(0deg,#ef5350,rgba(239,83,80,.3));margin:4px auto;border-radius:2px;"></div>
<div style="font-size:8px;color:#ef5350;margin-top:2px;">Gene: NPR2 √ó 2</div>
</div>
<div style="${base}left:50%;bottom:15px;transform:translateX(-50%);display:flex;align-items:center;gap:8px;">
<span style="font-size:18px;">‚ù§Ô∏è</span>
<span style="font-size:9px;color:#ff80ab;font-weight:700;">Community Care</span>
</div>`;

default: return `<div style="text-align:center;font-size:48px;margin-top:40px;">${s.emoji}</div>`;
}
}

// ============ TABS ============
function updateTabs(){
['tab1','tab2','tab3','tab4'].forEach((t,i)=>{
const el = document.getElementById(t);
const steps = ['predict','read','watch','record'];
el.className = 'step-tab';
if(state.step===steps[i]) el.classList.add('active');
else if(steps.indexOf(state.step)>i) el.classList.add('done');
});
}

// ============ HUD ============
function updateHUD(){
document.getElementById('hudScore').textContent = state.score;
document.getElementById('hudStreak').textContent = state.streak;
document.getElementById('hudCompleted').textContent = state.completedIds.length;
document.getElementById('hudAccuracy').textContent = state.completedIds.length>0?'100%':'‚Äî';
const pct = Math.min(100, (state.completedIds.length/5)*100);
document.getElementById('progressBar').style.width = pct+'%';
const remaining = Math.max(0, 5-state.completedIds.length);
const status = remaining>0? `Pick ${remaining} more you like!` : state.completedIds.length<8? `Extra Credit: ${state.completedIds.length}/8` : 'All 8 Complete! üéâ';
document.getElementById('progressStatus').textContent = status;
document.getElementById('scenarioCount').textContent = state.completedIds.length+' of 8 completed';
}

// ============ DATA TABLE ============
function addDataRow(row){
const tbody = document.getElementById('dataBody');
const tr = document.createElement('tr');
tr.className = 'new-row';
row.forEach(cell=>{
const td = document.createElement('td');
td.textContent = cell;
tr.appendChild(td);
});
tbody.appendChild(tr);
}

function copyTable(){
try{
const headers = 'Scenario\tWhat Happened?\tPerson/Situation Response\tConnection to Genetics?';
const rows = state.dataRows.map(r=>r.join('\t')).join('\n');
const text = headers+'\n'+rows;
navigator.clipboard.writeText(text).then(()=>{
const btn = document.getElementById('copyBtn');
btn.textContent = 'Copied!';
btn.classList.add('copied');
setTimeout(()=>{btn.textContent='üìã Copy Table';btn.classList.remove('copied');},2000);
}).catch(()=>{
const ta = document.createElement('textarea');
ta.value = text;
document.body.appendChild(ta);
ta.select();
document.execCommand('copy');
document.body.removeChild(ta);
const btn = document.getElementById('copyBtn');
btn.textContent = 'Copied!';
btn.classList.add('copied');
setTimeout(()=>{btn.textContent='üìã Copy Table';btn.classList.remove('copied');},2000);
});
}catch(e){console.error('Copy error:',e);}
}

// ============ SPEECH ============
let speechSynth = null;
let speechInitialized = false;

function initSpeech(){
if(speechInitialized) return;
try{
if('speechSynthesis' in window){
speechSynth = window.speechSynthesis;
speechInitialized = true;
}
}catch(e){console.error('Speech init error:',e);}
}

function toggleReadAloud(){
try{
if(!speechInitialized) initSpeech();
if(!speechSynth){
document.getElementById('readAloudBtn').textContent = 'Text Only';
return;
}
if(state.speechActive){
stopSpeech();
return;
}
const passageBox = document.getElementById('passageBox');
if(!passageBox) return;
const text = passageBox.innerText;
const utterance = new SpeechSynthesisUtterance(text);
utterance.rate = 0.9;
utterance.onend = ()=>{stopSpeech();};
utterance.onerror = ()=>{stopSpeech();};
speechSynth.speak(utterance);
state.speechActive = true;
document.getElementById('readAloudBtn').classList.add('reading');
document.getElementById('readAloudBtn').textContent = '‚èπ Stop';
// Chrome 15-second bug workaround
state.speechResumeInterval = setInterval(()=>{
try{if(speechSynth&&speechSynth.speaking){speechSynth.resume();}}catch(e){}
},10000);
// Safety timeout ‚Äî auto-stop after 60s
setTimeout(()=>{if(state.speechActive)stopSpeech();},60000);
}catch(e){
console.error('Speech error:',e);
stopSpeech();
document.getElementById('readAloudBtn').textContent = 'Text Only';
}
}

function stopSpeech(){
try{
if(state.speechResumeInterval){clearInterval(state.speechResumeInterval);state.speechResumeInterval=null;}
if(speechSynth){speechSynth.cancel();}
state.speechActive = false;
const rab = document.getElementById('readAloudBtn');
if(rab){rab.classList.remove('reading');rab.textContent='üîä Read Aloud';}
}catch(e){}
}

// ============ BANNERS ============
function showBanner(type){
const banner = document.getElementById('completionBanner');
const title = document.getElementById('bannerTitle');
const msg = document.getElementById('bannerMsg');
banner.classList.remove('hidden','ec-banner');
if(type==='required'){
title.textContent = 'üéâ Required Complete!';
msg.textContent = 'You finished 5 scenarios! Continue for Extra Credit?';
}else{
banner.classList.add('ec-banner');
title.textContent = 'üèÜ Extra Credit Complete!';
msg.textContent = 'Amazing ‚Äî you investigated all 8 genetic cases!';
}
}

function closeBanner(){
document.getElementById('completionBanner').classList.add('hidden');
}

// ============ PARTICLES ============
function spawnParticles(){
try{
const arena = document.querySelector('.center-content');
if(!arena) return;
const colors = ['#69f0ae','#b388ff','#ff80ab','#ffd740','#80d8ff'];
for(let i=0;i<12;i++){
const p = document.createElement('div');
p.className = 'particle';
p.style.cssText = `left:${30+Math.random()*40}%;top:${40+Math.random()*30}%;width:${4+Math.random()*6}px;height:${4+Math.random()*6}px;background:${colors[i%colors.length]};animation-delay:${i*80}ms;`;
arena.appendChild(p);
setTimeout(()=>{try{p.remove();}catch(e){}},2200);
}
}catch(e){}
}

// ============ RESET / NEW RUN ============
function resetSim(){
stopSpeech();
state = {currentScenario:null,step:null,readingLevel:state.readingLevel,completedIds:[],score:0,streak:0,predictions:{},speechActive:false,speechResumeInterval:null,dataRows:[]};
document.getElementById('dataBody').innerHTML = '';
document.getElementById('centerContent').innerHTML = `<div class="welcome" id="welcomeScreen">
<div class="welcome-emoji">üß¨üî¨üèîÔ∏è</div>
<div class="welcome-title">Investigate 8 Real Genetic Cases</div>
<div class="welcome-sub">Real people's lives were changed forever by their genetic code ‚Äî and scientists can prove it.<br><br>Pick a scenario from the left to start your investigation.</div>
</div>`;
document.getElementById('actionBtn').classList.add('hidden');
document.getElementById('readAloudBtn').classList.add('hidden');
['tab1','tab2','tab3','tab4'].forEach(t=>document.getElementById(t).className='step-tab');
renderScenarioCards();
updateHUD();
highlightKeyWords([]);
closeBanner();
}

function newRun(){resetSim();}

// ============ START ============
init();
</script>
</body>
</html>
